<!doctype html>
<html class="docs-version-2.3.1" lang="ja" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/ja/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/ja/blog/atom.xml" title="Apache Pulsar Atom Feed">
<script src="https://cdn.jsdelivr.net/npm/sine-waves@0.3.0/sine-waves.min.js" async></script><title data-react-helmet="true">Transport Encryption using TLS | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/ja/docs/2.3.1/security-tls-transport"><meta data-react-helmet="true" name="docusaurus_locale" content="ja"><meta data-react-helmet="true" name="docusaurus_version" content="2.3.1"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-2.3.1"><meta data-react-helmet="true" property="og:title" content="Transport Encryption using TLS | Apache Pulsar"><meta data-react-helmet="true" name="description" content="TLS Overview"><meta data-react-helmet="true" property="og:description" content="TLS Overview"><link data-react-helmet="true" rel="icon" href="/ja/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/ja/docs/2.3.1/security-tls-transport"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.3.1/security-tls-transport" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/zh-CN/docs/2.3.1/security-tls-transport" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/zh-TW/docs/2.3.1/security-tls-transport" hreflang="zh-TW"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/ja/docs/2.3.1/security-tls-transport" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/fr/docs/2.3.1/security-tls-transport" hreflang="fr"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/ko/docs/2.3.1/security-tls-transport" hreflang="ko"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/docs/2.3.1/security-tls-transport" hreflang="x-default"><link rel="stylesheet" href="/ja/assets/css/styles.1b024e02.css">
<link rel="preload" href="/ja/assets/js/runtime~main.9c76907b.js" as="script">
<link rel="preload" href="/ja/assets/js/main.80a1b655.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">メインコンテンツまでスキップ</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/ja/"><div class="navbar__logo"><img src="/ja/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/ja/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/ja/docs/2.3.1/concepts-overview">Pulsar Concepts</a></li><li><a class="dropdown__link navbar__link--active" href="/ja/docs/2.3.1/about">Quickstart</a></li><li><a class="dropdown__link" href="/ja/ecosystem">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link navbar__link--active" href="/ja/docs/2.3.1/">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/admin-rest-api">Admin REST API</a></li><li><a class="dropdown__link" href="/ja/functions-rest-api">Functions</a></li><li><a class="dropdown__link" href="/ja/source-rest-api">Sources</a></li><li><a class="dropdown__link" href="/ja/sink-rest-api">Sinks</a></li><li><a class="dropdown__link" href="/ja/packages-rest-api">Packages</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/pulsar-admin-cli">Pulsar Admin</a></li><li><a class="dropdown__link" href="/ja/pulsar-client-cli">Pulsar Client</a></li><li><a class="dropdown__link" href="/ja/pulsar-perf-cli">Pulsar Perf</a></li><li><a class="dropdown__link" href="/ja/pulsar-cli">Pulsar</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/community#welcome">Welcome</a></li><li><a class="dropdown__link" href="/ja/community#discussions">Discussions</a></li><li><a class="dropdown__link" href="/ja/community#governance">Governance</a></li><li><a class="dropdown__link" href="/ja/community#community">Meet the Community</a></li><li><a class="dropdown__link" href="/ja/community#how-to-contribute">Contribute</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/ja/blog">Blog</a></li><li><a class="dropdown__link" href="/ja/case-studies">Case Studies</a></li><li><a class="dropdown__link" href="/ja/resources">Resources</a></li><li><a class="dropdown__link" href="/ja/events">Events</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>日本語</span></span></a><ul class="dropdown__menu"><li><a href="/docs/2.3.1/security-tls-transport" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh-CN/docs/2.3.1/security-tls-transport" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（中国）</a></li><li><a href="/zh-TW/docs/2.3.1/security-tls-transport" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（台灣）</a></li><li><a href="/ja/docs/2.3.1/security-tls-transport" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">日本語</a></li><li><a href="/fr/docs/2.3.1/security-tls-transport" target="_self" rel="noopener noreferrer" class="dropdown__link">Français</a></li><li><a href="/ko/docs/2.3.1/security-tls-transport" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/ja/docs">Version</a><ul class="dropdown__menu"><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.9.1</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.9.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.8.2</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.8.1</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.8.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.3</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.2</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.1</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.4</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.3</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.2</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.1</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.2.0</span></a></li></ul></div><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/ja/docs/2.3.1/about">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/pulsar-2.0">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/concepts-overview">Concepts and Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/functions-overview">Pulsar Functions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/io-overview">Pulsar IO</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/sql-overview">Pulsar SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/deploy-aws">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/administration-zk-bk">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/ja/docs/2.3.1/security-overview">Security</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-overview">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/ja/docs/2.3.1/security-tls-transport">Transport Encryption using TLS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-tls-authentication">Authentication using TLS</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-token-client">Client Authentication using tokens</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-token-admin">Token authentication admin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-athenz">Authentication using Athenz</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-authorization">Authorization and ACLs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-encryption">End-to-End Encryption</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/ja/docs/2.3.1/security-extending">Extending</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/client-libraries-java">Client Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/admin-api-overview">Admin API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/adaptors-kafka">Adaptors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/cookbooks-tiered-storage">Cookbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/develop-tools">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/ja/docs/2.3.1/reference-terminology">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>これは<!-- -->Apache Pulsar<!-- --> <b>2.3.1</b>のドキュメントで現在はアクティブにメンテナンスされていません。</div><div class="margin-top--md">最新のドキュメントは<b><a href="/ja/docs/security-tls-transport">最新バージョン</a></b> (<!-- -->2.9.1<!-- -->) を見てください。</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.3.1</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Transport Encryption using TLS</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tls-overview">TLS Overview<a class="hash-link" href="#tls-overview" title="見出しへの直接リンク">​</a></h2><p>By default, Apache Pulsar clients communicate with the Apache Pulsar service in plain text, which means that all data is sent in the clear. TLS can be used to encrypt this traffic so that it cannot be snooped by a man-in-the-middle attacker.</p><p>TLS can be configured for both encryption and authentication. You may configure just TLS transport encryption, which is covered in this guide. TLS authentication is covered <a href="/ja/docs/2.3.1/security-tls-authentication">elsewhere</a>. Alternatively, you can use <a href="/ja/docs/2.3.1/security-athenz">another authentication mechanism</a> on top of TLS transport encryption.</p><blockquote><p>Note that enabling TLS may have a performance impact due to encryption overhead.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tls-concepts">TLS concepts<a class="hash-link" href="#tls-concepts" title="見出しへの直接リンク">​</a></h2><p>TLS is a form of <a href="https://en.wikipedia.org/wiki/Public-key_cryptography" target="_blank" rel="noopener noreferrer">public key cryptography</a>. Encryption is performed using key pairs consisting of a public key and a private key. Messages are encrypted with the public key and can be decrypted with the private key.</p><p>To use TLS transport encryption, you need two kinds of key pairs, <strong>server key pairs</strong> and a <strong>certificate authority</strong>.</p><p>A third kind of key pair, <strong>client key pairs</strong>, are used for <a href="/ja/docs/2.3.1/security-tls-authentication">client authentication</a>.</p><p>The <strong>certificate authority</strong> private key should be stored in a very secure location (a fully encrypted, disconnected, air gapped computer). The certificate authority public key, the <strong>trust cert</strong>, can be freely shared.</p><p>For both client and server key pairs, the administrator first generates a private key and a certificate request. Then the certificate authority private key is used to sign the certificate request, generating a certificate. This certificate is the public key for the server/client key pair.</p><p>For TLS transport encryption, the clients can use the <strong>trust cert</strong> to verify that the server they are talking to has a key pair that was signed by the certificate authority. A man-in-the-middle attacker would not have access to the certificate authority, so they couldn&#x27;t create a server with such a key pair.</p><p>For TLS authentication, the server uses the <strong>trust cert</strong> to verify that the client has a key pair that was signed by the certificate authority. The Common Name of the <strong>client cert</strong> is then used as the client&#x27;s role token (see <a href="/ja/docs/2.3.1/security-overview">Overview</a>).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="creating-tls-certificates">Creating TLS Certificates<a class="hash-link" href="#creating-tls-certificates" title="見出しへの直接リンク">​</a></h2><p>Creating TLS certificates for Pulsar involves creating a <a href="#certificate-authority">certificate authority</a> (CA), <a href="#server-certificate">server certificate</a>, and <a href="#client-certificate">client certificate</a>.</p><p>The following guide is an abridged guide to setting up a certificate authority. For a more detailed guide, there are plenty of resource on the internet. We recommend the <a href="https://jamielinux.com/docs/openssl-certificate-authority/index.html" target="_blank" rel="noopener noreferrer">this guide</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="certificate-authority">Certificate authority<a class="hash-link" href="#certificate-authority" title="見出しへの直接リンク">​</a></h3><p>The first step is to create the certificate for the CA. The CA will be used to sign both the broker and client certificates, in order to ensure that each party will trust the others. The CA should be stored in a very secure location (ideally completely disconnected from networks, air gapped, and fully encrypted).</p><p>Create a directory for your CA, and place <a href="https://github.com/apache/pulsar/tree/master/site2/website/static/examples/openssl.cnf" target="_blank" rel="noopener noreferrer">this openssl configuration file</a> in the directory. You may want to modify the default answers for company name and department in the configuration file. Export the location of the CA directory to the environment variable, CA_HOME. The configuration file uses this environment variable to find the rest of the files and directories needed for the CA.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> my-ca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">cd</span><span class="token plain"> my-ca</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">wget</span><span class="token plain"> https://raw.githubusercontent.com/apache/pulsar/master/site2/website/static/examples/openssl.cnf</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">CA_HOME</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable builtin class-name" style="color:rgb(189, 147, 249);font-style:italic">pwd</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>Create the necessary directories, keys and certs.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">mkdir</span><span class="token plain"> certs crl newcerts private</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> </span><span class="token number">700</span><span class="token plain"> private/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">touch</span><span class="token plain"> index.txt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">echo</span><span class="token plain"> </span><span class="token number">1000</span><span class="token plain"> </span><span class="token operator">&gt;</span><span class="token plain"> serial</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -aes256 -out private/ca.key.pem </span><span class="token number">4096</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> </span><span class="token number">400</span><span class="token plain"> private/ca.key.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req -config openssl.cnf -key private/ca.key.pem </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -new -x509 -days </span><span class="token number">7300</span><span class="token plain"> -sha256 -extensions v3_ca </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -out certs/ca.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token function" style="color:rgb(80, 250, 123)">chmod</span><span class="token plain"> </span><span class="token number">444</span><span class="token plain"> certs/ca.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>After answering the question prompts, this will store CA-related files in the <code>./my-ca</code> directory. Within that directory:</p><ul><li><code>certs/ca.cert.pem</code> is the public certificate. It is meant to be distributed to all parties involved.</li><li><code>private/ca.key.pem</code> is the private key. This is only needed when signing a new certificate for either broker or clients and it must be safely guarded.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="server-certificate">Server certificate<a class="hash-link" href="#server-certificate" title="見出しへの直接リンク">​</a></h3><p>Once a CA certificate has been created, you can create certificate requests and sign them with the CA.</p><p>The following commands will ask you a few questions and then create the certificates. When asked for the common name, you should match the hostname of the broker. You could also use a wildcard to match a group of broker hostnames, for example <code>*.broker.usw.example.com</code>. This ensures that the same certificate can be reused on multiple machines.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Sometimes it is not possible or makes no sense to match the hostname, such as when the brokers are created with random hostnames, or you plan to connect to the hosts via their IP. In this case, the client should be configured to disable TLS hostname verification. For more details, see <a href="#hostname-verification">the host verification section in client configuration</a>.</p></div></div><p>First generate the key.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl genrsa -out broker.key.pem </span><span class="token number">2048</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>The broker expects the key to be in <a href="https://en.wikipedia.org/wiki/PKCS_8" target="_blank" rel="noopener noreferrer">PKCS 8</a> format, so convert it.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl pkcs8 -topk8 -inform PEM -outform PEM </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -in broker.key.pem -out broker.key-pk8.pem -nocrypt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>Generate the certificate request...</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl req -config openssl.cnf </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -key broker.key.pem -new -sha256 -out broker.csr.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>... and sign it with the certificate authority.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">openssl ca -config openssl.cnf -extensions server_cert </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -days </span><span class="token number">1000</span><span class="token plain"> -notext -md sha256 </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    -in broker.csr.pem -out broker.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>At this point, you have a cert, <code>broker.cert.pem</code>, and a key, <code>broker.key-pk8.pem</code>, which can be used along with <code>ca.cert.pem</code> to configure TLS transport encryption for your broker and proxy nodes.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="broker-configuration">Broker Configuration<a class="hash-link" href="#broker-configuration" title="見出しへの直接リンク">​</a></h2><p>To configure a Pulsar <a href="/ja/docs/2.3.1/reference-terminology#broker">broker</a> to use TLS transport encryption, you&#x27;ll need to make some changes to <code>broker.conf</code>, which is located in the <code>conf</code> directory of your <a href="/ja/docs/2.3.1/getting-started-standalone">Pulsar installation</a>.</p><p>Add these values to the configuration file (substituting the appropriate certificate paths where necessary):</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsEnabled=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsCertificateFilePath=/path/to/broker.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsKeyFilePath=/path/to/broker.key-pk8.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsTrustCertsFilePath=/path/to/ca.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><blockquote><p>A full list of parameters available in the <code>conf/broker.conf</code> file, as well as the default values for those parameters, can be found in <a href="/ja/docs/2.3.1/reference-configuration#broker">Broker Configuration</a></p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tls-protocol-version-and-cipher">TLS Protocol Version and Cipher<a class="hash-link" href="#tls-protocol-version-and-cipher" title="見出しへの直接リンク">​</a></h3><p>The broker (and proxy) can be configured to require specific TLS protocol versions and ciphers for TLS negiotation. This can be used to stop clients from requesting downgraded TLS protocol versions or ciphers which may have weaknesses.</p><p>Both the TLS protocol versions and cipher properties can take multiple values, separated by commas. The possible values for protocol version and ciphers depend on the TLS provider being used. Pulsar uses OpenSSL if available, but if not defaults back to the JDK implementation.</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsProtocols=TLSv1.2,TLSv1.1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsCiphers=TLS_DH_RSA_WITH_AES_256_GCM_SHA384,TLS_DH_RSA_WITH_AES_256_CBC_SHA</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><p>OpenSSL currently supports <code>SSL2</code>, <code>SSL3</code>, <code>TLSv1</code>, <code>TLSv1.1</code> and <code>TLSv1.2</code> for the protocol version. A list of supported cipher can be acquired from the openssl ciphers command, i.e. <code>openssl ciphers -tls_v2</code>.</p><p>For JDK 8, a list of supported values can be obtained from the documentation:</p><ul><li><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#SSLContext" target="_blank" rel="noopener noreferrer">TLS protocol</a></li><li><a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/StandardNames.html#ciphersuites" target="_blank" rel="noopener noreferrer">Ciphers</a></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="proxy-configuration">Proxy Configuration<a class="hash-link" href="#proxy-configuration" title="見出しへの直接リンク">​</a></h2><p>Proxies need to configure TLS in two directions, for clients connecting to the proxy, and for the proxy to be able to connect to brokers.</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># For clients connecting to the proxy</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsEnabledInProxy=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsCertificateFilePath=/path/to/broker.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsKeyFilePath=/path/to/broker.key-pk8.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsTrustCertsFilePath=/path/to/ca.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># For the proxy to connect to brokers</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsEnabledWithBroker=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">brokerClientTrustCertsFilePath=/path/to/ca.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="client-configuration">Client configuration<a class="hash-link" href="#client-configuration" title="見出しへの直接リンク">​</a></h2><p>When TLS transport encryption is enabled, you need to configure the client to use <code>https://</code> and port 8443 for the web service URL, and <code>pulsar+ssl://</code> and port 6651 for the broker service URL.</p><p>As the server certificate you generated above doesn&#x27;t belong to any of the default trust chains, you also need to either specify the path the <strong>trust cert</strong> (recommended), or tell the client to allow untrusted server certs.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="hostname-verification">Hostname verification<a class="hash-link" href="#hostname-verification" title="見出しへの直接リンク">​</a></h3><p>Hostname verification is a TLS security feature whereby a client can refuse to connect to a server if the &quot;CommonName&quot; does not match the hostname to which it is connecting. By default, Pulsar clients disable hostname verification, as it requires that each broker has a DNS record and a unique cert.</p><p>Moreover, as the administrator has full control of the certificate authority, it is unlikely that a bad actor would be able to pull off a man-in-the-middle attack. &quot;allowInsecureConnection&quot; allows the client to connect to servers whose cert has not been signed by an approved CA. The client disables it by default, and should always be disabled in production environments. As long as &quot;allowInsecureConnection&quot; is disabled, a man-in-the-middle attack would require that the attacker has access to the CA.</p><p>One scenario where you may want to enable hostname verification is where you have multiple proxy nodes behind a VIP, and the VIP has a DNS record, for example, pulsar.mycompany.com. In this case, you can generate a TLS cert with pulsar.mycompany.com as the &quot;CommonName,&quot; and then enable hostname verification on the client.</p><p>The examples below show hostname verification being disabled for the Java client, though you can be omit this as the client disables it by default. C++/python clients do now allow this to be configured at the moment.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="cli-tools">CLI tools<a class="hash-link" href="#cli-tools" title="見出しへの直接リンク">​</a></h3><p><a href="/ja/docs/2.3.1/reference-cli-tools">Command-line tools</a> like <a href="/ja/docs/2.3.1/reference-cli-tools#pulsar-admin"><code>pulsar-admin</code></a>, <a href="/ja/docs/2.3.1/reference-cli-tools#pulsar-perf"><code>pulsar-perf</code></a>, and <a href="/ja/docs/2.3.1/reference-cli-tools#pulsar-client"><code>pulsar-client</code></a> use the <code>conf/client.conf</code> config file in a Pulsar installation.</p><p>You&#x27;ll need to add the following parameters to that file to use TLS transport with Pulsar&#x27;s CLI tools:</p><div class="codeBlockContainer_J+bg language-properties theme-code-block"><div class="codeBlockContent_csEI properties"><pre tabindex="0" class="prism-code language-properties codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">webServiceUrl=https://broker.example.com:8443/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">brokerServiceUrl=pulsar+ssl://broker.example.com:6651/</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">useTls=true</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsAllowInsecureConnection=false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsTrustCertsFilePath=/path/to/ca.cert.pem</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">tlsEnableHostnameVerification=false</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="java-client">Java client<a class="hash-link" href="#java-client" title="見出しへの直接リンク">​</a></h4><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.client.api.PulsarClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PulsarClient client = PulsarClient.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .serviceUrl(&quot;pulsar+ssl://broker.example.com:6651/&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .enableTls(true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .tlsTrustCertsFilePath(&quot;/path/to/ca.cert.pem&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .enableTlsHostnameVerification(false) // false by default, in any case</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .allowTlsInsecureConnection(false) // false by default, in any case</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="python-client">Python client<a class="hash-link" href="#python-client" title="見出しへの直接リンク">​</a></h4><div class="codeBlockContainer_J+bg language-python theme-code-block"><div class="codeBlockContent_csEI python"><pre tabindex="0" class="prism-code language-python codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> pulsar </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> Client</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client </span><span class="token operator">=</span><span class="token plain"> Client</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pulsar+ssl://broker.example.com:6651/&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                tls_hostname_verification</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                tls_trust_certs_file_path</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;/path/to/ca.cert.pem&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                tls_allow_insecure_connection</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">//</span><span class="token plain"> defaults to false </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> v2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token number">2.0</span><span class="token plain"> onwards</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div><h4 class="anchor anchorWithStickyNavbar_y2LR" id="c-client">C++ client<a class="hash-link" href="#c-client" title="見出しへの直接リンク">​</a></h4><div class="codeBlockContainer_J+bg language-c++ theme-code-block"><div class="codeBlockContent_csEI c++"><pre tabindex="0" class="prism-code language-c++ codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">#include &lt;pulsar/Client.h&gt;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ClientConfiguration config = ClientConfiguration();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config.setUseTls(true);  // shouldn&#x27;t be needed soon</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config.setTlsTrustCertsFilePath(caPath);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config.setTlsAllowInsecureConnection(false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config.setAuth(pulsar::AuthTls::create(clientPublicKeyPath, clientPrivateKeyPath));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">config.setValidateHostName(true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="クリップボードにコードをコピー" class="copyButton_M3SB clean-btn">コピー</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.3.1/security-tls-transport.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントのナビゲーション"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/ja/docs/2.3.1/security-overview"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">Overview</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/ja/docs/2.3.1/security-tls-authentication"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">Authentication using TLS</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tls-overview" class="table-of-contents__link toc-highlight">TLS Overview</a></li><li><a href="#tls-concepts" class="table-of-contents__link toc-highlight">TLS concepts</a></li><li><a href="#creating-tls-certificates" class="table-of-contents__link toc-highlight">Creating TLS Certificates</a><ul><li><a href="#certificate-authority" class="table-of-contents__link toc-highlight">Certificate authority</a></li><li><a href="#server-certificate" class="table-of-contents__link toc-highlight">Server certificate</a></li></ul></li><li><a href="#broker-configuration" class="table-of-contents__link toc-highlight">Broker Configuration</a><ul><li><a href="#tls-protocol-version-and-cipher" class="table-of-contents__link toc-highlight">TLS Protocol Version and Cipher</a></li></ul></li><li><a href="#proxy-configuration" class="table-of-contents__link toc-highlight">Proxy Configuration</a></li><li><a href="#client-configuration" class="table-of-contents__link toc-highlight">Client configuration</a><ul><li><a href="#hostname-verification" class="table-of-contents__link toc-highlight">Hostname verification</a></li><li><a href="#cli-tools" class="table-of-contents__link toc-highlight">CLI tools</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Foundation.</div><ul class="footer__items"><li class="footer__item">
	              <img src="/img/Apache_Feather_Logo.svg" alt="" width="20">
	              </li><li class="footer__item"><a href="http://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items"><li class="footer__item">
	              <div><small><strong>Apache Pulsar is available under the <a href="/">Apache License, version 2.0.</a></strong></small></div>
                <div>Apache Pulsar is a distributed, open source pub-sub messaging and streaming platform for real-time workloads, managing hundreds of billions of events per day.</div>
	              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/ja/"><img src="/ja/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/ja/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright"><p>Apache Pulsar is available under the Apache License, version 2.0.</p>
      <p>Inc.Copyright © 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</p></div></div></div></footer></div>
<script src="/ja/assets/js/runtime~main.9c76907b.js"></script>
<script src="/ja/assets/js/main.80a1b655.js"></script>
</body>
</html>
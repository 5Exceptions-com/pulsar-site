<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache Pulsar Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache Pulsar" href="/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@300;400;600&display=swap">
<script src="https://cdn.jsdelivr.net/npm/sine-waves@0.3.0/sine-waves.min.js" async></script><title data-react-helmet="true">Apache Pulsar 2.6.1 | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.com/blog/2020/08/21/Apache-Pulsar-2-6-1"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="default"><meta data-react-helmet="true" property="og:title" content="Apache Pulsar 2.6.1 | Apache Pulsar"><meta data-react-helmet="true" name="description" content="We are excited to see that the Apache Pulsar community has successfully released 2.6.1 version after a lot of hard work. It is a great milestone for this fast-growing project and the Pulsar community. 2.6.1 is the result of a big effort from the community, with over 100 commits and a long list of improvements and bug fixes."><meta data-react-helmet="true" property="og:description" content="We are excited to see that the Apache Pulsar community has successfully released 2.6.1 version after a lot of hard work. It is a great milestone for this fast-growing project and the Pulsar community. 2.6.1 is the result of a big effort from the community, with over 100 commits and a long list of improvements and bug fixes."><meta data-react-helmet="true" property="og:type" content="article"><meta data-react-helmet="true" property="article:published_time" content="2020-08-21T00:00:00.000Z"><meta data-react-helmet="true" property="article:author" content="https://twitter.com/wolf4j1"><link data-react-helmet="true" rel="icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.com/blog/2020/08/21/Apache-Pulsar-2-6-1"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/zh-CN/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/zh-TW/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="zh-TW"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/ja/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/fr/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="fr"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/ko/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="ko"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.com/blog/2020/08/21/Apache-Pulsar-2-6-1" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.704cfa6f.css">
<link rel="preload" href="/assets/js/runtime~main.f30c0772.js" as="script">
<link rel="preload" href="/assets/js/main.8ca565b9.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/docs/concepts-overview">Pulsar Concepts</a></li><li><a class="dropdown__link" href="/docs/about">Quickstart</a></li><li><a class="dropdown__link" href="/ecosystem">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link" href="/docs/about">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/admin-rest-api">Admin REST API</a></li><li><a class="dropdown__link" href="/functions-rest-api">Functions</a></li><li><a class="dropdown__link" href="/source-rest-api">Sources</a></li><li><a class="dropdown__link" href="/sink-rest-api">Sinks</a></li><li><a class="dropdown__link" href="/packages-rest-api">Packages</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/pulsar-admin-cli">Pulsar Admin</a></li><li><a class="dropdown__link" href="/pulsar-client-cli">Pulsar Client</a></li><li><a class="dropdown__link" href="/pulsar-perf-cli">Pulsar Perf</a></li><li><a class="dropdown__link" href="/pulsar-cli">Pulsar</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community#welcome">Welcome</a></li><li><a class="dropdown__link" href="/community#discussions">Discussions</a></li><li><a class="dropdown__link" href="/community#governance">Governance</a></li><li><a class="dropdown__link" href="/community#community">Meet the Community</a></li><li><a class="dropdown__link" href="/community#how-to-contribute">Contribute</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link dropdown__link--active" href="/blog">Blog</a></li><li><a class="dropdown__link" href="/case-studies">Case Studies</a></li><li><a class="dropdown__link" href="/resources">Resources</a></li><li><a class="dropdown__link" href="/events">Events</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/blog/2020/08/21/Apache-Pulsar-2-6-1" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">English</a></li><li><a href="/zh-CN/blog/2020/08/21/Apache-Pulsar-2-6-1" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（中国）</a></li><li><a href="/zh-TW/blog/2020/08/21/Apache-Pulsar-2-6-1" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（台灣）</a></li><li><a href="/ja/blog/2020/08/21/Apache-Pulsar-2-6-1" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/fr/blog/2020/08/21/Apache-Pulsar-2-6-1" target="_self" rel="noopener noreferrer" class="dropdown__link">Français</a></li><li><a href="/ko/blog/2020/08/21/Apache-Pulsar-2-6-1" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__link" href="/docs">Version</a><ul class="dropdown__menu"><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.9.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.8.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.0</span></a></li></ul></div><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper blog-wrapper blog-post-page"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_q+wC thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_9G5K margin-bottom--md">Recent posts</div><ul class="sidebarItemList_6T4b"><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/14/Apache-Pulsar-2-7-4">What’s New in Apache Pulsar 2.7.4</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/12/11/Log4j-CVE">Log4j2 Zero Day vulnerability (CVE-2021-44228)</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/09/23/Apache-Pulsar-2-8-1">Apache Pulsar 2.8.1</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/08/18/asia-cfp">Announcing Pulsar Summit Asia 2021: CFP Is Open!</a></li><li class="sidebarItem_cjdF"><a class="sidebarItemLink_zyXk" href="/blog/2021/08/11/Apache-Pulsar-2-7-3">Apache Pulsar 2.7.3</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_d4p0" itemprop="headline">Apache Pulsar 2.6.1</h1><div class="blogPostData_-Im+ margin-vert--md"><time datetime="2020-08-21T00:00:00.000Z" itemprop="datePublished">August 21, 2020</time> · <!-- -->11 min read</div><div class="row margin-top--md margin-bottom--sm"><div class="col col--6 authorCol_8c0z"><div class="avatar margin-bottom--sm"><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://twitter.com/wolf4j1" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">XiaoLong Ran</span></a></div></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>We are excited to see that the Apache Pulsar community has successfully released 2.6.1 version after a lot of hard work. It is a great milestone for this fast-growing project and the Pulsar community. 2.6.1 is the result of a big effort from the community, with over 100 commits and a long list of improvements and bug fixes.</p><p>Here are some highlights and major features added in Pulsar 2.6.1.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="broker">Broker<a class="hash-link" href="#broker" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="limit-the-batch-size-to-the-minimum-of-the-maxnumberofmessages-and-maxsizeofmessages">Limit the batch size to the minimum of the <code>maxNumberOfMessages</code> and <code>maxSizeOfMessages</code><a class="hash-link" href="#limit-the-batch-size-to-the-minimum-of-the-maxnumberofmessages-and-maxsizeofmessages" title="Direct link to heading">​</a></h3><ol><li><p>Batch size is not limited to the minimum of the <code>maxNumberOfMessages</code> and <code>maxSizeOfMessages</code> from the BatchReceive policy.</p></li><li><p>When the batch size is greater than the <code>receiveQ</code> of the consumer (for example, the batch size is 3000 and a receiveQ is 500), the following issue occurs:</p><p>In a multi-topic (pattern) consumer, the client stops receiving any messages. The client gets paused and never resumed when setting a timeout in the batch policy. Only one batch is fetched and the client is never resumed.</p></li></ol><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/6865" target="_blank" rel="noopener noreferrer">PR-6865</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-hash-range-conflict-issue-in-key_shared-subscription-with-sticky-hash-range">Fix hash range conflict issue in Key_Shared subscription with sticky hash range<a class="hash-link" href="#fix-hash-range-conflict-issue-in-key_shared-subscription-with-sticky-hash-range" title="Direct link to heading">​</a></h3><p>In <code>Key_Shared</code> subscription where the <code>stickyHashRange</code> is used, consumers are not allowed to use interleaving hashes.</p><p>The pull request fixes the hash range conflict issue in <code>Key_Shared</code> with sticky hash range.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7231" target="_blank" rel="noopener noreferrer">PR-7231</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-get-lookup-permission-error">Fix get lookup permission error<a class="hash-link" href="#fix-get-lookup-permission-error" title="Direct link to heading">​</a></h3><p>If the <code>canProduce</code> or <code>canConsume</code> method throws an exception, the <code>canLookup</code> method just throws the exception and does not check other permissions. The code snippet is as follows: </p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    return canLookupAsync(topicName, role, authenticationData)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            .get(conf.getZooKeeperOperationTimeoutSeconds(), SECONDS);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>PR-7234 invokes <code>canLookupAsync</code>. When Pulsar AuthorizationService checks lookup permission, if the user has the <code>canProducer</code> or <code>canConsumer</code> role, the user performs <code>canLookup</code> operations.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7234" target="_blank" rel="noopener noreferrer">PR-7234</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="avoid-introducing-null-read-position-for-the-managed-cursor">Avoid introducing null read position for the managed cursor<a class="hash-link" href="#avoid-introducing-null-read-position-for-the-managed-cursor" title="Direct link to heading">​</a></h3><p>Avoid introducing null read position for the managed cursor. The most doubtful thing is the <code>getNextValidPosition</code> method in the <code>ManagedLedgerImpl</code>. If a given position is greater than the position added last time, it returns a <code>null</code> value, and the read position is also <code>null</code>.</p><p>In this PR, we add a log and print the stack trace to find the root cause and fallback to the next position if the <code>null</code> occurs at the next valid position.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7264" target="_blank" rel="noopener noreferrer">PR-7264</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-error-in-creation-of-non-durable-cursor">Fix error in creation of non-durable cursor<a class="hash-link" href="#fix-error-in-creation-of-non-durable-cursor" title="Direct link to heading">​</a></h3><p>An NPE occurs when we fail to create a non-durable cursor and continue to create the subscription instance. </p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    cursor = ledger.newNonDurableCursor(startPosition, subscriptionName);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">} catch (ManagedLedgerException e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    subscriptionFuture.completeExceptionally(e);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">return new PersistentSubscription(this, subscriptionName, cursor, false);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Additionally, the NPE leads to the topic usage count increasing to 1. When deleting a topic, the topic cannot be deleted even if you use the force flag.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7355" target="_blank" rel="noopener noreferrer">PR-7355</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="avoid-an-npe-occurs-in-the-managedledgerimplisoffloadedneedsdelete-method">Avoid an NPE occurs in the <code>ManagedLedgerImpl.isOffloadedNeedsDelete</code> method<a class="hash-link" href="#avoid-an-npe-occurs-in-the-managedledgerimplisoffloadedneedsdelete-method" title="Direct link to heading">​</a></h3><p>When the default value of the <code>offload-deletion-lag</code> is set to <code>null</code>, an NPE occurs. To fix the bug, null check is added in the <code>ManagedLedgerImpl.isOffloadedNeedsDelete</code> method.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7389" target="_blank" rel="noopener noreferrer">PR-7389</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-producer-stuck-issue-due-to-npe-when-creating-a-new-ledger">Fix producer stuck issue due to NPE when creating a new ledger<a class="hash-link" href="#fix-producer-stuck-issue-due-to-npe-when-creating-a-new-ledger" title="Direct link to heading">​</a></h3><p>NPE occurs when creating a ledger if the network address is unresolvable. If NPE occurs before adding the timeout task, the timeout mechanism does not work. The unresolvable network address is common in the Kubernetes environment. It happens when a bookie pod or a worker node restarts.</p><p>This pull request fixes from the following perspectives:</p><ol><li>Catch the NPE when creating a new ledger.</li><li>When the timeout task is triggered, it always executes the callback. It is totally fine because we already have the logic to ensure the callback is triggered only once.</li><li>Add a mechanism to detect that the <code>CreatingLedger</code> state is not moving.</li></ol><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7401" target="_blank" rel="noopener noreferrer">PR-7401</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-npe-when-using-advertisedlisteners">Fix NPE when using advertisedListeners<a class="hash-link" href="#fix-npe-when-using-advertisedlisteners" title="Direct link to heading">​</a></h3><p>The broker failed to acquire ownership for the namespace bundle when using <code>advertisedListeners=internal:pulsar://node1:6650,external:pulsar://node1.external:6650</code> with external listener name. Correct <code>BrokerServiceUrlTls</code> when TLS is not enabled.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7620" target="_blank" rel="noopener noreferrer">PR-7620</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-the-issue-that-the-deduplication-cursor-cannot-be-deleted-after-message-deduplication-is-disabled">Fix the issue that the deduplication cursor cannot be deleted after message deduplication is disabled<a class="hash-link" href="#fix-the-issue-that-the-deduplication-cursor-cannot-be-deleted-after-message-deduplication-is-disabled" title="Direct link to heading">​</a></h3><p>When enabling the message deduplication in the <code>broker.conf</code> file, disabling it and then restarting the broker, the deduplication cursor is not deleted.</p><p>This PR fixes the issue, so when you disable message deduplication, you can delete the deduplication cursor.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7656" target="_blank" rel="noopener noreferrer">PR-7656</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-the-issue-that-getlastentry-reads-entry--1">Fix the issue that GetLastEntry() reads entry <code>-1</code><a class="hash-link" href="#fix-the-issue-that-getlastentry-reads-entry--1" title="Direct link to heading">​</a></h3><p>Previously, the code does not include a return statement. If the entry is set to <code>-1</code>, after sending code, the response reads the entry and sends a second response, as shown in the following example.</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16:34:25.779 [pulsar-io-54-7:org.apache.bookkeeper.client.LedgerHandle@748] ERROR org.apache.bookkeeper.client.LedgerHandle - IncorrectParameterException on ledgerId:0 firstEntry:-1 lastEntry:-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16:34:25.779 [pulsar-client-io-82-1:org.apache.pulsar.client.impl.ConsumerImpl@1986] INFO  org.apache.pulsar.client.impl.ConsumerImpl - [persistent://external-repl-prop/pulsar-function-admin/assignment][c-use-fw-localhost-0-function-assignment-initialize-reader-b21f7607c9] Successfully getLastMessageId 0:-1</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16:34:25.779 [pulsar-client-io-82-1:org.apache.pulsar.client.impl.ClientCnx@602] WARN  org.apache.pulsar.client.impl.ClientCnx - [id: 0xc78f4a0e, L:/127.0.0.1:55657 - R:localhost/127.0.0.1:55615] Received error from server: Failed to get batch size for entry org.apache.bookkeeper.mledger.ManagedLedgerException: Incorrect parameter input</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">16:34:25.779 [pulsar-client-io-82-1:org.apache.pulsar.client.impl.ClientCnx@612] WARN  org.apache.pulsar.client.impl.ClientCnx - [id: 0xc78f4a0e, L:/127.0.0.1:55657 - R:localhost/127.0.0.1:55615] Received unknown request id from server: 10</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>PR-7495 adds a return statement to code, so GetLastEntry() reads the last entry, instead of <code>-1</code>.  </p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7495" target="_blank" rel="noopener noreferrer">PR-7495</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-the-error-of-updating-partitions-for-non-persistent-topic">Fix the error of updating partitions for non-persistent topic<a class="hash-link" href="#fix-the-error-of-updating-partitions-for-non-persistent-topic" title="Direct link to heading">​</a></h3><p>When updating partitions on a non-persistent topic, Error 409 is returned. The pull request fixes partitions errors for non-persistent topics.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7459" target="_blank" rel="noopener noreferrer">PR-7459</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="zookeeper">ZooKeeper<a class="hash-link" href="#zookeeper" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="use-hostname-for-bookie-rack-awareness-mapping">Use hostname for bookie rack awareness mapping<a class="hash-link" href="#use-hostname-for-bookie-rack-awareness-mapping" title="Direct link to heading">​</a></h3><p>In <a href="https://github.com/apache/pulsar/pull/5607" target="_blank" rel="noopener noreferrer">PR-5607</a>, the <code>useHostName()</code> is added with <code>return false</code>. The rack-aware policy passes the Bookie&#x27;s hostname into an IP address and then uses that IP address to figure out to which rack the bookie belongs.</p><p>Then two issues occur: </p><ol><li>The IP does not match the hostname which is recorded in the <code>/bookies</code> z-node</li><li>If there is an error in parsing the bookie hostname (eg: transient DNS error), an NPE is triggered and the BK client never realizes that this bookie is available in the cluster.</li></ol><p>The exception is thrown at Line 77(as shown in the following code snippet), since <code>getAddress()</code> returns a <code>null</code> given that the address is parsed.  </p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">74        if (dnsResolver.useHostName()) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">75            names.add(addr.getHostName());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">76        } else {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">77            names.add(addr.getAddress().getHostAddress());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">78        }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The default implementation for the <code>DnsResolver.useHostName()</code> returns <code>true</code>.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7361" target="_blank" rel="noopener noreferrer">PR-7361</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="java-client">Java Client<a class="hash-link" href="#java-client" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-the-issue-that-the-http-header-used-in-athenz-authentication-can-not-be-renamed">Fix the issue that the HTTP header used in Athenz authentication can not be renamed<a class="hash-link" href="#fix-the-issue-that-the-http-header-used-in-athenz-authentication-can-not-be-renamed" title="Direct link to heading">​</a></h3><p>The authentication plugin for Athenz allows users to change the name of the HTTP header for sending an authentication token to a broker server with a parameter named <code>roleHeader</code>. The change uses the value of the <code>roleHeader</code> parameter on the <code>AuthenticationAthenz</code> side, and uses it directly as the header name.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7311" target="_blank" rel="noopener noreferrer">PR-7311</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-the-issue-that-batch-ack-set-is-recycled-multiple-times">Fix the issue that batch ack set is recycled multiple times<a class="hash-link" href="#fix-the-issue-that-batch-ack-set-is-recycled-multiple-times" title="Direct link to heading">​</a></h3><p>The batch ack sets are recycled multiple times, due to race condition in group ack flush and cumulative Ack. So we add a recycled state check for the ack set in PR-7409, and fix the recycle issue.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7409" target="_blank" rel="noopener noreferrer">PR-7409</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="add-authentication-client-with-oauth2-support">Add authentication client with OAuth2 support<a class="hash-link" href="#add-authentication-client-with-oauth2-support" title="Direct link to heading">​</a></h3><p>Pulsar supports authenticating clients using OAuth 2.0 access tokens. You can use tokens to identify a Pulsar client and associate with some &quot;principal&quot; (or &quot;role&quot;) that is permitted to do some actions, for example, publish messages to a topic or consume messages from a topic. </p><p>This module is to support Pulsar Client Authentication Plugin for OAuth 2.0 directly. The client communicates with the Oauth 2.0 server, gets an <code>access token</code> from the Oauth 2.0 server, and passes the <code>access token</code> to Pulsar broker to do the authentication.</p><p>So, the broker can use <code>org.apache.pulsar.broker.authentication.AuthenticationProviderToken</code>,
and the user can add their own <code>AuthenticationProvider</code> to work with this module.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7420" target="_blank" rel="noopener noreferrer">PR-7420</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="not-subscribe-to-the-topic-when-the-consumer-is-closed">Not subscribe to the topic when the consumer is closed<a class="hash-link" href="#not-subscribe-to-the-topic-when-the-consumer-is-closed" title="Direct link to heading">​</a></h3><p>Fix race condition on the closed consumer while reconnecting to the broker.</p><p>The race condition happens when the consumer reconnects to the broker. The connection of the consumer is set to <code>null</code> when the consumer reconnects to the broker. If the consumer is not connected to broker at this time, the client does not send the consumer command to the broker. So, when the consumer reconnects to the broker, the consumer sends the subscribe command again. </p><p>This pull request adds a state check when the <code>connectionOpened()</code> of the consumer opens. If the consumer is in closing or closed state, the consumer does not send the subscribe command.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7589" target="_blank" rel="noopener noreferrer">PR-7589</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="oauth2-authentication-plugin-uses-asynchttpclient">OAuth2 authentication plugin uses AsyncHttpClient<a class="hash-link" href="#oauth2-authentication-plugin-uses-asynchttpclient" title="Direct link to heading">​</a></h3><p>Previously, the OAuth2 client authentication plugin used Apache HTTP client lib to make requests, Apache HTTP client is used to validate hostname. As suggested in <a href="https://github.com/apache/pulsar/issues/7612" target="_blank" rel="noopener noreferrer">#7612</a>, we get rid of the dependency of using Apache HTTP client.</p><p>In PR-7615, OAuth2 client authentication plugin uses AsyncHttpClient, which is used in client and broker. For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7615" target="_blank" rel="noopener noreferrer">PR-7615</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="cpp-client">CPP Client<a class="hash-link" href="#cpp-client" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="cpp-oauth2-authentication-client">CPP Oauth2 authentication client<a class="hash-link" href="#cpp-oauth2-authentication-client" title="Direct link to heading">​</a></h3><p>Pulsar supports authenticating clients using OAuth 2.0 access tokens. You can use tokens to identify a Pulsar client and associate with some &quot;principal&quot; (or &quot;role&quot;) that is permitted to do some actions (eg: publish messages to a topic or consume messages from a topic). This change tries to support it in cpp client.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7467" target="_blank" rel="noopener noreferrer">PR-7467</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-partition-index-error-in-close-callback">Fix partition index error in close callback<a class="hash-link" href="#fix-partition-index-error-in-close-callback" title="Direct link to heading">​</a></h3><p>In partitioned producer/consumer&#x27;s close callback, the partition index is always <code>0</code>. The <code>ProducerImpl/ConsumerImpl</code> internal partition index field should be passed to <code>PartitionedProducerImpl/PartitionedConsumerImpl</code> close callback.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7282" target="_blank" rel="noopener noreferrer">PR-7282</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-segment-crashes-caused-by-race-condition-of-timer-in-cpp-client">Fix segment crashes caused by race condition of timer in CPP client<a class="hash-link" href="#fix-segment-crashes-caused-by-race-condition-of-timer-in-cpp-client" title="Direct link to heading">​</a></h3><p>Segment crashes occur in a race condition:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain">- The close operation calls the `keepAliveTimer_.reset()`.</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">- The `keepAliveTimer` is called by `startConsumerStatsTimer` and `handleKeepAliveTimeout` methods. Actually, the `keepAliveTimer` should not be called by those two methods.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This pull request fixes those issues.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7572" target="_blank" rel="noopener noreferrer">PR-7572</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="add-support-to-read-credentials-from-file">Add support to read credentials from file<a class="hash-link" href="#add-support-to-read-credentials-from-file" title="Direct link to heading">​</a></h3><p>Support reading credentials from a file to make it align with the Java client.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7606" target="_blank" rel="noopener noreferrer">PR-7606</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-multi-topic-consumer-segfault-on-connection-error">Fix multi-topic consumer segfault on connection error<a class="hash-link" href="#fix-multi-topic-consumer-segfault-on-connection-error" title="Direct link to heading">​</a></h3><p>The multi-topic consumer triggers a segfault when an error occurs in creating a consumer. This is due to the calls to close the partial consumers with a null callback.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7588" target="_blank" rel="noopener noreferrer">PR-7588</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="functions">Functions<a class="hash-link" href="#functions" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="use-fully-qualified-hostname-as-default-to-advertise-worker">Use fully qualified hostname as default to advertise worker<a class="hash-link" href="#use-fully-qualified-hostname-as-default-to-advertise-worker" title="Direct link to heading">​</a></h3><p>There is a difference in getting hostnames between <code>Java 8</code> and <code>Java 11</code>. In Java 8, <code>InetAddress.getLocalHost().getHostName()</code> returns the fully qualified hostname; in Java 11, it returns a simple hostname. In this case, we should rather use the <code>getCanonicalHostName()</code>, which returns the fully qualified hostname. This is the same method to get the advertised address for workers as well.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7360" target="_blank" rel="noopener noreferrer">PR-7360</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="fix-the-function-bc-issue-introduced-in-release-260">Fix the function BC issue introduced in release 2.6.0<a class="hash-link" href="#fix-the-function-bc-issue-introduced-in-release-260" title="Direct link to heading">​</a></h3><p>A backwards compatibility breakage is introduced in <a href="https://github.com/apache/pulsar/pull/5985" target="_blank" rel="noopener noreferrer">PR-5985</a>. When the running function workers are separated from brokers, updating workers and brokers independently from release 2.5.0 to 2.6.0 results in the following error:</p><div class="codeBlockContainer_J+bg language-text theme-code-block"><div class="codeBlockContent_csEI text"><pre tabindex="0" class="prism-code language-text codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">java.lang.NullPointerException: null\n\tat java.net.URI$Parser.parse(URI.java:3104) ~[?:?]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">java.net.URI.&lt;init&gt;(URI.java:600) ~[?:?]\n\tat java.net.URI.create(URI.java:881) ~[?:?]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.pulsar.functions.worker.WorkerUtils.initializeDlogNamespace(WorkerUtils.java:160) ~[org.apache.pulsar-pulsar-functions-worker-2.7.0-SNAPSHOT.jar:2.7.0-SNAPSHOT]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.pulsar.functions.worker.Worker.initialize(Worker.java:155) ~[org.apache.pulsar-pulsar-functions-worker-2.7.0-SNAPSHOT.jar:2.7.0-SNAPSHOT] </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.pulsar.functions.worker.Worker.start(Worker.java:69) ~[org.apache.pulsar-pulsar-functions-worker-2.7.0-SNAPSHOT.jar:2.7.0-SNAPSHOT] </span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">org.apache.pulsar.functions.worker.FunctionWorkerStarter.main(FunctionWorkerStarter.java:67) [org.apache.pulsar-pulsar-functions-worker-2.7.0-SNAPSHOT.jar:2.7.0-SNAPSHOT]</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This is because the broker 2.5.0 supports &quot;bookkeeperMetadataServiceUri&quot; and the admin client returns a <code>null</code> field, thus causing the NPE.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7528" target="_blank" rel="noopener noreferrer">PR-7528</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="pulsar-perf">pulsar-perf<a class="hash-link" href="#pulsar-perf" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="support-tlsallowinsecureconnection-in-pulsar-perf-produceconsumeread-performance-tests">Support <code>tlsAllowInsecureConnection</code> in pulsar-perf produce/consume/read performance tests<a class="hash-link" href="#support-tlsallowinsecureconnection-in-pulsar-perf-produceconsumeread-performance-tests" title="Direct link to heading">​</a></h3><p>Add <code>tlsAllowInsecureConnection</code> config to the CLI tool <strong>pulsar-perf</strong>, to support produce/consume/read performance tests to clusters with insecure TLS connections.</p><p>For more information about implementation, see <a href="https://github.com/apache/pulsar/pull/7300" target="_blank" rel="noopener noreferrer">PR-7300</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="more-information">More information<a class="hash-link" href="#more-information" title="Direct link to heading">​</a></h2><ul><li>To download Apache Pulsar 2.6.1, click <a href="https://pulsar.apache.org/en/download/" target="_blank" rel="noopener noreferrer">download</a>.</li><li>For more information about Apache Pulsar 2.6.1, see <a href="https://pulsar.apache.org/release-notes/#2.6.1" target="_blank" rel="noopener noreferrer">2.6.1 release notes</a> and <a href="https://github.com/apache/pulsar/pulls?q=is%3Apr+label%3Arelease%2F2.6.1+is%3Aclosed" target="_blank" rel="noopener noreferrer">2.6.1 PR list</a>.</li></ul><p>If you have any questions or suggestions, contact us with mailing lists or slack.</p><ul><li><a href="mailto:users@pulsar.apache.org" target="_blank" rel="noopener noreferrer">users@pulsar.apache.org</a></li><li><a href="mailto:dev@pulsar.apache.org" target="_blank" rel="noopener noreferrer">dev@pulsar.apache.org</a></li><li>Pulsar slack channel: <a href="https://apache-pulsar.slack.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.slack.com/</a></li><li>Self-registration at <a href="https://apache-pulsar.herokuapp.com/" target="_blank" rel="noopener noreferrer">https://apache-pulsar.herokuapp.com/</a></li></ul><p>Looking forward to your contributions to <a href="https://github.com/apache/pulsar" target="_blank" rel="noopener noreferrer">Pulsar</a>.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/blog/2020/08/24/Pulsar-300-contributors"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">« <!-- -->Apache Pulsar Celebrates 300 Contributors</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/blog/2020/06/18/Apache-Pulsar-2-6-0"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">Apache Pulsar 2.6.0<!-- --> »</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#broker" class="table-of-contents__link toc-highlight">Broker</a><ul><li><a href="#limit-the-batch-size-to-the-minimum-of-the-maxnumberofmessages-and-maxsizeofmessages" class="table-of-contents__link toc-highlight">Limit the batch size to the minimum of the <code>maxNumberOfMessages</code> and <code>maxSizeOfMessages</code></a></li><li><a href="#fix-hash-range-conflict-issue-in-key_shared-subscription-with-sticky-hash-range" class="table-of-contents__link toc-highlight">Fix hash range conflict issue in Key_Shared subscription with sticky hash range</a></li><li><a href="#fix-get-lookup-permission-error" class="table-of-contents__link toc-highlight">Fix get lookup permission error</a></li><li><a href="#avoid-introducing-null-read-position-for-the-managed-cursor" class="table-of-contents__link toc-highlight">Avoid introducing null read position for the managed cursor</a></li><li><a href="#fix-error-in-creation-of-non-durable-cursor" class="table-of-contents__link toc-highlight">Fix error in creation of non-durable cursor</a></li><li><a href="#avoid-an-npe-occurs-in-the-managedledgerimplisoffloadedneedsdelete-method" class="table-of-contents__link toc-highlight">Avoid an NPE occurs in the <code>ManagedLedgerImpl.isOffloadedNeedsDelete</code> method</a></li><li><a href="#fix-producer-stuck-issue-due-to-npe-when-creating-a-new-ledger" class="table-of-contents__link toc-highlight">Fix producer stuck issue due to NPE when creating a new ledger</a></li><li><a href="#fix-npe-when-using-advertisedlisteners" class="table-of-contents__link toc-highlight">Fix NPE when using advertisedListeners</a></li><li><a href="#fix-the-issue-that-the-deduplication-cursor-cannot-be-deleted-after-message-deduplication-is-disabled" class="table-of-contents__link toc-highlight">Fix the issue that the deduplication cursor cannot be deleted after message deduplication is disabled</a></li><li><a href="#fix-the-issue-that-getlastentry-reads-entry--1" class="table-of-contents__link toc-highlight">Fix the issue that GetLastEntry() reads entry <code>-1</code></a></li><li><a href="#fix-the-error-of-updating-partitions-for-non-persistent-topic" class="table-of-contents__link toc-highlight">Fix the error of updating partitions for non-persistent topic</a></li></ul></li><li><a href="#zookeeper" class="table-of-contents__link toc-highlight">ZooKeeper</a><ul><li><a href="#use-hostname-for-bookie-rack-awareness-mapping" class="table-of-contents__link toc-highlight">Use hostname for bookie rack awareness mapping</a></li></ul></li><li><a href="#java-client" class="table-of-contents__link toc-highlight">Java Client</a><ul><li><a href="#fix-the-issue-that-the-http-header-used-in-athenz-authentication-can-not-be-renamed" class="table-of-contents__link toc-highlight">Fix the issue that the HTTP header used in Athenz authentication can not be renamed</a></li><li><a href="#fix-the-issue-that-batch-ack-set-is-recycled-multiple-times" class="table-of-contents__link toc-highlight">Fix the issue that batch ack set is recycled multiple times</a></li><li><a href="#add-authentication-client-with-oauth2-support" class="table-of-contents__link toc-highlight">Add authentication client with OAuth2 support</a></li><li><a href="#not-subscribe-to-the-topic-when-the-consumer-is-closed" class="table-of-contents__link toc-highlight">Not subscribe to the topic when the consumer is closed</a></li><li><a href="#oauth2-authentication-plugin-uses-asynchttpclient" class="table-of-contents__link toc-highlight">OAuth2 authentication plugin uses AsyncHttpClient</a></li></ul></li><li><a href="#cpp-client" class="table-of-contents__link toc-highlight">CPP Client</a><ul><li><a href="#cpp-oauth2-authentication-client" class="table-of-contents__link toc-highlight">CPP Oauth2 authentication client</a></li><li><a href="#fix-partition-index-error-in-close-callback" class="table-of-contents__link toc-highlight">Fix partition index error in close callback</a></li><li><a href="#fix-segment-crashes-caused-by-race-condition-of-timer-in-cpp-client" class="table-of-contents__link toc-highlight">Fix segment crashes caused by race condition of timer in CPP client</a></li><li><a href="#add-support-to-read-credentials-from-file" class="table-of-contents__link toc-highlight">Add support to read credentials from file</a></li><li><a href="#fix-multi-topic-consumer-segfault-on-connection-error" class="table-of-contents__link toc-highlight">Fix multi-topic consumer segfault on connection error</a></li></ul></li><li><a href="#functions" class="table-of-contents__link toc-highlight">Functions</a><ul><li><a href="#use-fully-qualified-hostname-as-default-to-advertise-worker" class="table-of-contents__link toc-highlight">Use fully qualified hostname as default to advertise worker</a></li><li><a href="#fix-the-function-bc-issue-introduced-in-release-260" class="table-of-contents__link toc-highlight">Fix the function BC issue introduced in release 2.6.0</a></li></ul></li><li><a href="#pulsar-perf" class="table-of-contents__link toc-highlight">pulsar-perf</a><ul><li><a href="#support-tlsallowinsecureconnection-in-pulsar-perf-produceconsumeread-performance-tests" class="table-of-contents__link toc-highlight">Support <code>tlsAllowInsecureConnection</code> in pulsar-perf produce/consume/read performance tests</a></li></ul></li><li><a href="#more-information" class="table-of-contents__link toc-highlight">More information</a></li></ul></div></div></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Foundation.</div><ul class="footer__items"><li class="footer__item">
	              <img src="/img/Apache_Feather_Logo.svg" alt="" width="20">
	              </li><li class="footer__item"><a href="http://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items"><li class="footer__item">
	              <div><small><strong>Apache Pulsar is available under the <a href="/">Apache License, version 2.0.</a></strong></small></div>
                <div>Apache Pulsar is a distributed, open source pub-sub messaging and streaming platform for real-time workloads, managing hundreds of billions of events per day.</div>
	              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/"><img src="/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright"><p>Apache Pulsar is available under the Apache License, version 2.0.</p>
      <p>Inc.Copyright © 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</p></div></div></div></footer></div>
<script src="/assets/js/runtime~main.f30c0772.js"></script>
<script src="/assets/js/main.8ca565b9.js"></script>
</body>
</html>
<!doctype html>
<html class="docs-version-2.3.1" lang="zh-CN" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/zh-CN/blog/rss.xml" title="Apache Pulsar RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh-CN/blog/atom.xml" title="Apache Pulsar Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache Pulsar" href="/zh-CN/opensearch.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Red+Hat+Display:wght@300;400;600&display=swap">
<script src="https://cdn.jsdelivr.net/npm/sine-waves@0.3.0/sine-waves.min.js" async></script><title data-react-helmet="true">The Pulsar Java client | Apache Pulsar</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://pulsar.apache.org/zh-CN/docs/2.3.1/client-libraries-java"><meta data-react-helmet="true" name="docsearch:language" content="zh-CN"><meta data-react-helmet="true" name="docsearch:version" content="2.3.1"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-2.3.1"><meta data-react-helmet="true" property="og:title" content="The Pulsar Java client | Apache Pulsar"><meta data-react-helmet="true" name="description" content="The Pulsar Java client can be used both to create Java producers, consumers, and readers of messages and to perform administrative tasks. The current version of the Java client is @pulsar:version@."><meta data-react-helmet="true" property="og:description" content="The Pulsar Java client can be used both to create Java producers, consumers, and readers of messages and to perform administrative tasks. The current version of the Java client is @pulsar:version@."><link data-react-helmet="true" rel="icon" href="/zh-CN/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pulsar.apache.org/zh-CN/docs/2.3.1/client-libraries-java"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/docs/2.3.1/client-libraries-java" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/zh-CN/docs/2.3.1/client-libraries-java" hreflang="zh-CN"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/zh-TW/docs/2.3.1/client-libraries-java" hreflang="zh-TW"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/ja/docs/2.3.1/client-libraries-java" hreflang="ja"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/fr/docs/2.3.1/client-libraries-java" hreflang="fr"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/ko/docs/2.3.1/client-libraries-java" hreflang="ko"><link data-react-helmet="true" rel="alternate" href="https://pulsar.apache.org/docs/2.3.1/client-libraries-java" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh-CN/assets/css/styles.80ab528c.css">
<link rel="preload" href="/zh-CN/assets/js/runtime~main.701451b8.js" as="script">
<link rel="preload" href="/zh-CN/assets/js/main.e8b2c7c8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="tailwind navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh-CN/"><div class="navbar__logo"><img src="/zh-CN/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/zh-CN/img/logo.svg" alt="pulasr logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a></div><div class="navbar__items navbar__items--right"><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Get Started</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/zh-CN/docs/2.3.1/concepts-overview">Pulsar Concepts</a></li><li><a class="dropdown__link navbar__link--active" href="/zh-CN/docs/2.3.1/about">Quickstart</a></li><li><a class="dropdown__link" href="/zh-CN/ecosystem">Ecosystem</a></li></ul></div><a class="navbar__item navbar__link navbar__link--active" href="/zh-CN/docs/2.3.1/about">Docs</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">REST APIs</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/admin-rest-api">Admin REST API</a></li><li><a class="dropdown__link" href="/zh-CN/functions-rest-api">Functions</a></li><li><a class="dropdown__link" href="/zh-CN/source-rest-api">Sources</a></li><li><a class="dropdown__link" href="/zh-CN/sink-rest-api">Sinks</a></li><li><a class="dropdown__link" href="/zh-CN/packages-rest-api">Packages</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">CLI</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/pulsar-admin-cli">Pulsar Admin</a></li><li><a class="dropdown__link" href="/zh-CN/pulsar-client-cli">Pulsar Client</a></li><li><a class="dropdown__link" href="/zh-CN/pulsar-perf-cli">Pulsar Perf</a></li><li><a class="dropdown__link" href="/zh-CN/pulsar-cli">Pulsar</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/community#welcome">Welcome</a></li><li><a class="dropdown__link" href="/zh-CN/community#discussions">Discussions</a></li><li><a class="dropdown__link" href="/zh-CN/community#governance">Governance</a></li><li><a class="dropdown__link" href="/zh-CN/community#community">Meet the Community</a></li><li><a class="dropdown__link" href="/zh-CN/community#how-to-contribute">Contribute</a></li><li><a href="https://github.com/apache/pulsar/wiki" target="_blank" rel="noopener noreferrer" class="dropdown__link">Wiki</a></li><li><a href="https://github.com/apache/pulsar/issues" target="_blank" rel="noopener noreferrer" class="dropdown__link">Issue Tracking</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link">Learn</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/zh-CN/blog">Blog</a></li><li><a class="dropdown__link" href="/zh-CN/case-studies">Case Studies</a></li><li><a class="dropdown__link" href="/zh-CN/resources">Resources</a></li><li><a class="dropdown__link" href="/zh-CN/events">Events</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__link"><span><svg viewBox="0 0 20 20" width="20" height="20" aria-hidden="true" class="iconLanguage_zID8"><path fill="currentColor" d="M19.753 10.909c-.624-1.707-2.366-2.726-4.661-2.726-.09 0-.176.002-.262.006l-.016-2.063 3.525-.607c.115-.019.133-.119.109-.231-.023-.111-.167-.883-.188-.976-.027-.131-.102-.127-.207-.109-.104.018-3.25.461-3.25.461l-.013-2.078c-.001-.125-.069-.158-.194-.156l-1.025.016c-.105.002-.164.049-.162.148l.033 2.307s-3.061.527-3.144.543c-.084.014-.17.053-.151.143.019.09.19 1.094.208 1.172.018.08.072.129.188.107l2.924-.504.035 2.018c-1.077.281-1.801.824-2.256 1.303-.768.807-1.207 1.887-1.207 2.963 0 1.586.971 2.529 2.328 2.695 3.162.387 5.119-3.06 5.769-4.715 1.097 1.506.256 4.354-2.094 5.98-.043.029-.098.129-.033.207l.619.756c.08.096.206.059.256.023 2.51-1.73 3.661-4.515 2.869-6.683zm-7.386 3.188c-.966-.121-.944-.914-.944-1.453 0-.773.327-1.58.876-2.156a3.21 3.21 0 011.229-.799l.082 4.277a2.773 2.773 0 01-1.243.131zm2.427-.553l.046-4.109c.084-.004.166-.01.252-.01.773 0 1.494.145 1.885.361.391.217-1.023 2.713-2.183 3.758zm-8.95-7.668a.196.196 0 00-.196-.145h-1.95a.194.194 0 00-.194.144L.008 16.916c-.017.051-.011.076.062.076h1.733c.075 0 .099-.023.114-.072l1.008-3.318h3.496l1.008 3.318c.016.049.039.072.113.072h1.734c.072 0 .078-.025.062-.076-.014-.05-3.083-9.741-3.494-11.04zm-2.618 6.318l1.447-5.25 1.447 5.25H3.226z"></path></svg><span>中文（中国）</span></span></a><ul class="dropdown__menu"><li><a href="/docs/2.3.1/client-libraries-java" target="_self" rel="noopener noreferrer" class="dropdown__link">English</a></li><li><a href="/zh-CN/docs/2.3.1/client-libraries-java" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active">中文（中国）</a></li><li><a href="/zh-TW/docs/2.3.1/client-libraries-java" target="_self" rel="noopener noreferrer" class="dropdown__link">中文（台灣）</a></li><li><a href="/ja/docs/2.3.1/client-libraries-java" target="_self" rel="noopener noreferrer" class="dropdown__link">日本語</a></li><li><a href="/fr/docs/2.3.1/client-libraries-java" target="_self" rel="noopener noreferrer" class="dropdown__link">Français</a></li><li><a href="/ko/docs/2.3.1/client-libraries-java" target="_self" rel="noopener noreferrer" class="dropdown__link">한국어</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a aria-current="page" class="navbar__link" href="/zh-CN/docs">Version</a><ul class="dropdown__menu"><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.9.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.8.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.7.0</span></a></li><li><a rel="noopener noreferrer" class="dropdown__link"><span>2.6.0</span></a></li></ul></div><div class="toggle_iYfV toggle_iQ2x toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">🌜</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">🌞</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div><div class="searchBox_Utm0"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/zh-CN/docs/2.3.1/about">About</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/pulsar-2.0">Getting Started</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/concepts-overview">Concepts and Architecture</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/functions-overview">Pulsar Functions</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/io-overview">Pulsar IO</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/sql-overview">Pulsar SQL</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/deploy-aws">Deployment</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/administration-zk-bk">Administration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/security-overview">Security</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/zh-CN/docs/2.3.1/client-libraries-java">Client Libraries</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/zh-CN/docs/2.3.1/client-libraries-java">Java</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.3.1/client-libraries-go">Go</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.3.1/client-libraries-python">Python</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.3.1/client-libraries-cpp">C++</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/zh-CN/docs/2.3.1/client-libraries-websocket">WebSocket</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/admin-api-overview">Admin API</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/adaptors-kafka">Adaptors</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/cookbooks-tiered-storage">Cookbooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/develop-tools">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/zh-CN/docs/2.3.1/reference-terminology">Reference</a></div></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="theme-doc-version-banner alert alert--warning margin-bottom--md" role="alert"><div>This is documentation for <!-- -->Apache Pulsar<!-- --> <b>2.3.1</b>, which is no longer actively maintained.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/zh-CN/docs/client-libraries-java">latest version</a></b> (<!-- -->2.9.1<!-- -->).</div></div><div class="docItemContainer_oiyr"><article><span class="theme-doc-version-badge badge badge--secondary">Version: <!-- -->2.3.1</span><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>The Pulsar Java client</h1></header><p>The Pulsar Java client can be used both to create Java producers, consumers, and <a href="#reader-interface">readers</a> of messages and to perform <a href="/zh-CN/docs/2.3.1/admin-api-overview">administrative tasks</a>. The current version of the Java client is <strong>@pulsar:version@</strong>.</p><p>Javadoc for the Pulsar client is divided up into two domains, by package:</p><table><thead><tr><th align="left">Package</th><th align="left">Description</th><th align="left">Maven Artifact</th></tr></thead><tbody><tr><td align="left"><a href="/zh-CN/api/client"><code>org.apache.pulsar.client.api</code></a></td><td align="left">The producer and consumer API</td><td align="left"><a href="http://search.maven.org/#artifactdetails%7Corg.apache.pulsar%7Cpulsar-client%7C@pulsar:version@%7Cjar" target="_blank" rel="noopener noreferrer">org.apache.pulsar:pulsar-client:@pulsar:version@</a></td></tr><tr><td align="left"><a href="/zh-CN/api/admin"><code>org.apache.pulsar.client.admin</code></a></td><td align="left">The Java <a href="/zh-CN/docs/2.3.1/admin-api-overview">admin API</a></td><td align="left"><a href="http://search.maven.org/#artifactdetails%7Corg.apache.pulsar%7Cpulsar-client-admin%7C@pulsar:version@%7Cjar" target="_blank" rel="noopener noreferrer">org.apache.pulsar:pulsar-client-admin:@pulsar:version@</a></td></tr></tbody></table><p>This document will focus only on the client API for producing and consuming messages on Pulsar topics. For a guide to using the Java admin client, see <a href="/zh-CN/docs/2.3.1/admin-api-overview">The Pulsar admin interface</a>.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="installation">Installation<a class="hash-link" href="#installation" title="Direct link to heading">​</a></h2><p>The latest version of the Pulsar Java client library is available via <a href="http://search.maven.org/#artifactdetails%7Corg.apache.pulsar%7Cpulsar-client%7C@pulsar:version@%7Cjar" target="_blank" rel="noopener noreferrer">Maven Central</a>. To use the latest version, add the <code>pulsar-client</code> library to your build configuration.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="maven">Maven<a class="hash-link" href="#maven" title="Direct link to heading">​</a></h3><p>If you&#x27;re using Maven, add this to your <code>pom.xml</code>:</p><div class="codeBlockContainer_J+bg language-xml theme-code-block"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- in your &lt;properties&gt; block --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">pulsar.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">@pulsar:version@</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">pulsar.version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">&lt;!-- in your &lt;dependencies&gt; block --&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">org.apache.pulsar</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">groupId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">pulsar-client</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">artifactId</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain">${pulsar.version}</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">version</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&lt;/</span><span class="token tag" style="color:rgb(255, 121, 198)">dependency</span><span class="token tag punctuation" style="color:rgb(248, 248, 242)">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="gradle">Gradle<a class="hash-link" href="#gradle" title="Direct link to heading">​</a></h3><p>If you&#x27;re using Gradle, add this to your <code>build.gradle</code> file:</p><div class="codeBlockContainer_J+bg language-groovy theme-code-block"><div class="codeBlockContent_csEI groovy"><pre tabindex="0" class="prism-code language-groovy codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">def pulsarVersion = &#x27;@pulsar:version@&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">dependencies {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    compile group: &#x27;org.apache.pulsar&#x27;, name: &#x27;pulsar-client&#x27;, version: pulsarVersion</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="connection-urls">Connection URLs<a class="hash-link" href="#connection-urls" title="Direct link to heading">​</a></h2><p>To connect to Pulsar using client libraries, you need to specify a <a href="/zh-CN/docs/2.3.1/developing-binary-protocol">Pulsar protocol</a> URL.</p><p>Pulsar protocol URLs are assigned to specific clusters, use the <code>pulsar</code> scheme and have a default port of 6650. Here&#x27;s an example for <code>localhost</code>:</p><div class="codeBlockContainer_J+bg language-http theme-code-block"><div class="codeBlockContent_csEI http"><pre tabindex="0" class="prism-code language-http codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar://localhost:6650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>A URL for a production Pulsar cluster may look something like this:</p><div class="codeBlockContainer_J+bg language-http theme-code-block"><div class="codeBlockContent_csEI http"><pre tabindex="0" class="prism-code language-http codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar://pulsar.us-west.example.com:6650</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If you&#x27;re using <a href="/zh-CN/docs/2.3.1/security-tls-authentication">TLS</a> authentication, the URL will look like something like this:</p><div class="codeBlockContainer_J+bg language-http theme-code-block"><div class="codeBlockContent_csEI http"><pre tabindex="0" class="prism-code language-http codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">pulsar+ssl://pulsar.us-west.example.com:6651</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="client-configuration">Client configuration<a class="hash-link" href="#client-configuration" title="Direct link to heading">​</a></h2><p>You can instantiate a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/PulsarClient" target="_blank" rel="noopener noreferrer">PulsarClient</a> object using just a URL for the target Pulsar <a href="/zh-CN/docs/2.3.1/reference-terminology#cluster">cluster</a>, like this:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PulsarClient client = PulsarClient.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .serviceUrl(&quot;pulsar://localhost:6650&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="default-broker-urls-for-standalone-clusters">Default broker URLs for standalone clusters<a class="hash-link" href="#default-broker-urls-for-standalone-clusters" title="Direct link to heading">​</a></h4><p>If you&#x27;re running a cluster in <a href="/zh-CN/docs/2.3.1/getting-started-standalone">standalone mode</a>, the broker will be available at the <code>pulsar://localhost:6650</code> URL by default.</p></blockquote><p>Check out the Javadoc for the <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/PulsarClient" target="_blank" rel="noopener noreferrer">PulsarClient</a> class for a full listing of configurable parameters.</p><blockquote><p>In addition to client-level configuration, you can also apply <a href="#configuring-producers">producer</a> and <a href="#configuring-consumers">consumer</a> specific configuration, as you&#x27;ll see in the sections below.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="producers">Producers<a class="hash-link" href="#producers" title="Direct link to heading">​</a></h2><p>In Pulsar, producers write messages to topics. Once you&#x27;ve instantiated a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/PulsarClient" target="_blank" rel="noopener noreferrer">PulsarClient</a> object (as in the section <a href="#client-configuration">above</a>), you can create a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/Producer" target="_blank" rel="noopener noreferrer">Producer</a> for a specific Pulsar <a href="/zh-CN/docs/2.3.1/reference-terminology#topic">topic</a>.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;byte[]&gt; producer = client.newProducer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;my-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// You can then send messages to the broker and topic you specified:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.send(&quot;My message&quot;.getBytes());</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>By default, producers produce messages that consist of byte arrays. You can produce different types, however, by specifying a message <a href="#schemas">schema</a>.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;String&gt; stringProducer = client.newProducer(Schema.STRING)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;my-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">stringProducer.send(&quot;My message&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><p>You should always make sure to close your producers, consumers, and clients when they are no longer needed:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumer.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">client.close();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Close operations can also be asynchronous:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.closeAsync()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   .thenRun(() -&gt; System.out.println(&quot;Producer closed&quot;));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   .exceptionally((ex) -&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       System.err.println(&quot;Failed to close producer: &quot; + ex);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">       return ex;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">   });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-producers">Configuring producers<a class="hash-link" href="#configuring-producers" title="Direct link to heading">​</a></h3><p>If you instantiate a <code>Producer</code> object specifying only a topic name, as in the example above, the producer will use the default configuration. To use a non-default configuration, there&#x27;s a variety of configurable parameters that you can set. For a full listing, see the Javadoc for the <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/ProducerBuilder" target="_blank" rel="noopener noreferrer">ProducerBuilder</a> class. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;byte[]&gt; producer = client.newProducer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(&quot;my-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .batchingMaxPublishDelay(10, TimeUnit.MILLISECONDS)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .sendTimeout(10, TimeUnit.SECONDS)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .blockIfQueueFull(true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="message-routing">Message routing<a class="hash-link" href="#message-routing" title="Direct link to heading">​</a></h3><p>When using partitioned topics, you can specify the routing mode whenever you publish messages using a producer. For more on specifying a routing mode using the Java client, see the <a href="/zh-CN/docs/2.3.1/cookbooks-partitioned">Partitioned Topics</a> cookbook.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="async-send">Async send<a class="hash-link" href="#async-send" title="Direct link to heading">​</a></h3><p>You can also publish messages <a href="/zh-CN/docs/2.3.1/concepts-messaging#send-modes">asynchronously</a> using the Java client. With async send, the producer will put the message in a blocking queue and return immediately. The client library will then send the message to the broker in the background. If the queue is full (max size configurable), the producer could be blocked or fail immediately when calling the API, depending on arguments passed to the producer.</p><p>Here&#x27;s an example async send operation:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.sendAsync(&quot;my-async-message&quot;.getBytes()).thenAccept(msgId -&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    System.out.printf(&quot;Message with ID %s successfully sent&quot;, msgId);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">});</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As you can see from the example above, async send operations return a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/MessageId" target="_blank" rel="noopener noreferrer">MessageId</a> wrapped in a <a href="http://www.baeldung.com/java-completablefuture" target="_blank" rel="noopener noreferrer"><code>CompletableFuture</code></a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-messages">Configuring messages<a class="hash-link" href="#configuring-messages" title="Direct link to heading">​</a></h3><p>In addition to a value, it&#x27;s possible to set additional items on a given message:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">producer.newMessage()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .key(&quot;my-message-key&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .value(&quot;my-async-message&quot;.getBytes())</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .property(&quot;my-key&quot;, &quot;my-value&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .property(&quot;my-other-key&quot;, &quot;my-other-value&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .send();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As for the previous case, it&#x27;s also possible to terminate the builder chain with <code>sendAsync()</code> and get a future returned.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="consumers">Consumers<a class="hash-link" href="#consumers" title="Direct link to heading">​</a></h2><p>In Pulsar, consumers subscribe to topics and handle messages that producers publish to those topics. You can instantiate a new <a href="/zh-CN/docs/2.3.1/reference-terminology#consumer">consumer</a> by first instantiating a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/PulsarClient" target="_blank" rel="noopener noreferrer">PulsarClient</a> object and passing it a URL for a Pulsar broker (as <a href="#client-configuration">above</a>).</p><p>Once you&#x27;ve instantiated a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/PulsarClient" target="_blank" rel="noopener noreferrer">PulsarClient</a> object, you can create a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/Consumer" target="_blank" rel="noopener noreferrer">Consumer</a> by specifying a <a href="/zh-CN/docs/2.3.1/reference-terminology#topic">topic</a> and a <a href="/zh-CN/docs/2.3.1/concepts-messaging#subscription-modes">subscription</a>.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer consumer = client.newConsumer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;my-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscriptionName(&quot;my-subscription&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The <code>subscribe</code> method will automatically subscribe the consumer to the specified topic and subscription. One way to make the consumer listen on the topic is to set up a <code>while</code> loop. In this example loop, the consumer listens for messages, prints the contents of any message that&#x27;s received, and then <a href="/zh-CN/docs/2.3.1/reference-terminology#acknowledgment-ack">acknowledges</a> that the message has been processed. If the processing logic fails, we use <a href="/zh-CN/docs/2.3.1/reference-terminology#acknowledgment-ack">negative acknowledgement</a> to have the message redelivered at a later point in time.</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">while (true) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  // Wait for a message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  Message msg = consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      // Do something with the message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      System.out.printf(&quot;Message received: %s&quot;, new String(msg.getData()));</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      // Acknowledge the message so that it can be deleted by the message broker</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      consumer.acknowledge(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  } catch (Exception e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      // Message failed to process, redeliver later</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      consumer.negativeAcknowledge(msg);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="configuring-consumers">Configuring consumers<a class="hash-link" href="#configuring-consumers" title="Direct link to heading">​</a></h3><p>If you instantiate a <code>Consumer</code> object specifying only a topic and subscription name, as in the example above, the consumer will use the default configuration. To use a non-default configuration, there&#x27;s a variety of configurable parameters that you can set. For a full listing, see the Javadoc for the <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/ConsumerBuilder" target="_blank" rel="noopener noreferrer">ConsumerBuilder</a> class. Here&#x27;s an example:</p><p>Here&#x27;s an example configuration:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer consumer = client.newConsumer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;my-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscriptionName(&quot;my-subscription&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .ackTimeout(10, TimeUnit.SECONDS)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscriptionType(SubscriptionType.Exclusive)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="async-receive">Async receive<a class="hash-link" href="#async-receive" title="Direct link to heading">​</a></h3><p>The <code>receive</code> method will receive messages synchronously (the consumer process will be blocked until a message is available). You can also use <a href="/zh-CN/docs/2.3.1/concepts-messaging#receive-modes">async receive</a>, which will return immediately with a <a href="http://www.baeldung.com/java-completablefuture" target="_blank" rel="noopener noreferrer"><code>CompletableFuture</code></a> object that completes once a new message is available.</p><p>Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">CompletableFuture&lt;Message&gt; asyncMessage = consumer.receiveAsync();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Async receive operations return a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/Message" target="_blank" rel="noopener noreferrer">Message</a> wrapped inside of a <a href="http://www.baeldung.com/java-completablefuture" target="_blank" rel="noopener noreferrer"><code>CompletableFuture</code></a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="multi-topic-subscriptions">Multi-topic subscriptions<a class="hash-link" href="#multi-topic-subscriptions" title="Direct link to heading">​</a></h3><p>In addition to subscribing a consumer to a single Pulsar topic, you can also subscribe to multiple topics simultaneously using <a href="/zh-CN/docs/2.3.1/concepts-messaging#multi-topic-subscriptions">multi-topic subscriptions</a>. To use multi-topic subscriptions you can supply either a regular expression (regex) or a <code>List</code> of topics. If you select topics via regex, all topics must be within the same Pulsar namespace.</p><p>Here are some examples:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.client.api.Consumer;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import org.apache.pulsar.client.api.PulsarClient;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.Arrays;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.List;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">import java.util.regex.Pattern;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ConsumerBuilder consumerBuilder = pulsarClient.newConsumer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscriptionName(subscription);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Subscribe to all topics in a namespace</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Pattern allTopicsInNamespace = Pattern.compile(&quot;persistent://public/default/.*&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer allTopicsConsumer = consumerBuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topicsPattern(allTopicsInNamespace)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Subscribe to a subsets of topics in a namespace, based on regex</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Pattern someTopicsInNamespace = Pattern.compile(&quot;persistent://public/default/foo.*&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer allTopicsConsumer = consumerBuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topicsPattern(someTopicsInNamespace)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You can also subscribe to an explicit list of topics (across namespaces if you wish):</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">List&lt;String&gt; topics = Arrays.asList(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;topic-1&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;topic-2&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        &quot;topic-3&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer multiTopicConsumer = consumerBuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topics(topics)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">// Alternatively:</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Consumer multiTopicConsumer = consumerBuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topics(</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;topic-1&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;topic-2&quot;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            &quot;topic-3&quot;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        )</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribe();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You can also subscribe to multiple topics asynchronously using the <code>subscribeAsync</code> method rather than the synchronous <code>subscribe</code> method. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Pattern allTopicsInNamespace = Pattern.compile(&quot;persistent://public/default.*&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">consumerBuilder</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topics(topics)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .subscribeAsync()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .thenAccept(consumer -&gt; {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            do {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                try {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    Message msg = consumer.receive();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    // Do something with the received message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                } catch (PulsarClientException e) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    e.printStackTrace();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            } while (true);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        });</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="reader-interface">Reader interface<a class="hash-link" href="#reader-interface" title="Direct link to heading">​</a></h2><p>With the <a href="/zh-CN/docs/2.3.1/concepts-clients#reader-interface">reader interface</a>, Pulsar clients can &quot;manually position&quot; themselves within a topic, reading all messages from a specified message onward. The Pulsar API for Java enables you to create  <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/Reader" target="_blank" rel="noopener noreferrer">Reader</a> objects by specifying a topic, a <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/MessageId" target="_blank" rel="noopener noreferrer">MessageId</a>, and <a href="https://pulsar.apache.org/api/client/org/apache/pulsar/client/api/ReaderConfiguration" target="_blank" rel="noopener noreferrer">ReaderConfiguration</a>.</p><p>Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">ReaderConfiguration conf = new ReaderConfiguration();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">byte[] msgIdBytes = // Some message ID byte array</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">MessageId id = MessageId.fromByteArray(msgIdBytes);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Reader reader = pulsarClient.newReader()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(topic)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .startMessageId(id)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">while (true) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    Message message = reader.readNext();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // Process message</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>In the example above, a <code>Reader</code> object is instantiated for a specific topic and message (by ID); the reader then iterates over each message in the topic after the message identified by <code>msgIdBytes</code> (how that value is obtained depends on the application).</p><p>The code sample above shows pointing the <code>Reader</code> object to a specific message (by ID), but you can also use <code>MessageId.earliest</code> to point to the earliest available message on the topic of <code>MessageId.latest</code> to point to the most recent available message.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="schemas">Schemas<a class="hash-link" href="#schemas" title="Direct link to heading">​</a></h2><p>In Pulsar, all message data consists of byte arrays &quot;under the hood.&quot; <a href="/zh-CN/docs/2.3.1/concepts-schema-registry">Message schemas</a> enable you to use other types of data when constructing and handling messages (from simple types like strings to more complex, application-specific types). If you construct, say, a <a href="#producers">producer</a> without specifying a schema, then the producer can only produce messages of type <code>byte[]</code>. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;byte[]&gt; producer = client.newProducer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(topic)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The producer above is equivalent to a <code>Producer&lt;byte[]&gt;</code> (in fact, you should <em>always</em> explicitly specify the type). If you&#x27;d like to use a producer for a different type of data, you&#x27;ll need to specify a <strong>schema</strong> that informs Pulsar which data type will be transmitted over the <a href="/zh-CN/docs/2.3.1/reference-terminology#topic">topic</a>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="schema-example">Schema example<a class="hash-link" href="#schema-example" title="Direct link to heading">​</a></h3><p>Let&#x27;s say that you have a <code>SensorReading</code> class that you&#x27;d like to transmit over a Pulsar topic:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">public class SensorReading {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public float temperature;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public SensorReading(float temperature) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.temperature = temperature;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    // A no-arg constructor is required</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public SensorReading() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public float getTemperature() {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        return temperature;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    public void setTemperature(float temperature) {</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        this.temperature = temperature;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>You could then create a <code>Producer&lt;SensorReading&gt;</code> (or <code>Consumer&lt;SensorReading&gt;</code>) like so:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;SensorReading&gt; producer = client.newProducer(JSONSchema.of(SensorReading.class))</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .topic(&quot;sensor-readings&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>The following schema formats are currently available for Java:</p><ul><li><p>No schema or the byte array schema (which can be applied using <code>Schema.BYTES</code>):</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;byte[]&gt; bytesProducer = client.newProducer(Schema.BYTES)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(&quot;some-raw-bytes-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Or, equivalently:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;byte[]&gt; bytesProducer = client.newProducer()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(&quot;some-raw-bytes-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p><code>String</code> for normal UTF-8-encoded string data. This schema can be applied using <code>Schema.STRING</code>:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;String&gt; stringProducer = client.newProducer(Schema.STRING)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(&quot;some-string-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li><li><p>JSON schemas can be created for POJOs using the <code>JSONSchema</code> class. Here&#x27;s an example:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Schema&lt;MyPojo&gt; pojoSchema = JSONSchema.of(MyPojo.class);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Producer&lt;MyPojo&gt; pojoProducer = client.newProducer(pojoSchema)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .topic(&quot;some-pojo-topic&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    .create();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="authentication">Authentication<a class="hash-link" href="#authentication" title="Direct link to heading">​</a></h2><p>Pulsar currently supports two authentication schemes: <a href="/zh-CN/docs/2.3.1/security-tls-authentication">TLS</a> and <a href="/zh-CN/docs/2.3.1/security-athenz">Athenz</a>. The Pulsar Java client can be used with both.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="tls-authentication">TLS Authentication<a class="hash-link" href="#tls-authentication" title="Direct link to heading">​</a></h3><p>To use <a href="/zh-CN/docs/2.3.1/security-tls-authentication">TLS</a>, you need to set TLS to <code>true</code> using the <code>setUseTls</code> method, point your Pulsar client to a TLS cert path, and provide paths to cert and key files.</p><p>Here&#x27;s an example configuration:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Map&lt;String, String&gt; authParams = new HashMap();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;tlsCertFile&quot;, &quot;/path/to/client-cert.pem&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;tlsKeyFile&quot;, &quot;/path/to/client-key.pem&quot;);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Authentication tlsAuth = AuthenticationFactory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create(AuthenticationTls.class.getName(), authParams);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PulsarClient client = PulsarClient.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .serviceUrl(&quot;pulsar+ssl://my-broker.com:6651&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .enableTls(true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .tlsTrustCertsFilePath(&quot;/path/to/cacert.pem&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .authentication(tlsAuth)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="athenz">Athenz<a class="hash-link" href="#athenz" title="Direct link to heading">​</a></h3><p>To use <a href="/zh-CN/docs/2.3.1/security-athenz">Athenz</a> as an authentication provider, you need to <a href="#tls-authentication">use TLS</a> and provide values for four parameters in a hash:</p><ul><li><code>tenantDomain</code></li><li><code>tenantService</code></li><li><code>providerDomain</code></li><li><code>privateKey</code></li></ul><p>You can also set an optional <code>keyId</code>. Here&#x27;s an example configuration:</p><div class="codeBlockContainer_J+bg language-java theme-code-block"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Map&lt;String, String&gt; authParams = new HashMap();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;tenantDomain&quot;, &quot;shopping&quot;); // Tenant domain name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;tenantService&quot;, &quot;some_app&quot;); // Tenant service name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;providerDomain&quot;, &quot;pulsar&quot;); // Provider domain name</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;privateKey&quot;, &quot;file:///path/to/private.pem&quot;); // Tenant private key path</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">authParams.put(&quot;keyId&quot;, &quot;v1&quot;); // Key id for the tenant private key (optional, default: &quot;0&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">Authentication athenzAuth = AuthenticationFactory</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .create(AuthenticationAthenz.class.getName(), authParams);</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">PulsarClient client = PulsarClient.builder()</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .serviceUrl(&quot;pulsar+ssl://my-broker.com:6651&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .enableTls(true)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .tlsTrustCertsFilePath(&quot;/path/to/cacert.pem&quot;)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .authentication(athenzAuth)</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        .build();</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><blockquote><h4 class="anchor anchorWithStickyNavbar_y2LR" id="supported-pattern-formats">Supported pattern formats<a class="hash-link" href="#supported-pattern-formats" title="Direct link to heading">​</a></h4><p>The <code>privateKey</code> parameter supports the following three pattern formats: <em> <code>file:///path/to/file</code> </em> <code>file:/path/to/file</code> * <code>data:application/x-pem-file;base64,&lt;base64-encoded value&gt;</code></p></blockquote></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/apache/pulsar/edit/master/site2/website-next/versioned_docs/version-2.3.1/client-libraries-java.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh-CN/docs/2.3.1/security-extending"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Extending</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh-CN/docs/2.3.1/client-libraries-go"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Go</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#installation" class="table-of-contents__link toc-highlight">Installation</a><ul><li><a href="#maven" class="table-of-contents__link toc-highlight">Maven</a></li><li><a href="#gradle" class="table-of-contents__link toc-highlight">Gradle</a></li></ul></li><li><a href="#connection-urls" class="table-of-contents__link toc-highlight">Connection URLs</a></li><li><a href="#client-configuration" class="table-of-contents__link toc-highlight">Client configuration</a></li><li><a href="#producers" class="table-of-contents__link toc-highlight">Producers</a><ul><li><a href="#configuring-producers" class="table-of-contents__link toc-highlight">Configuring producers</a></li><li><a href="#message-routing" class="table-of-contents__link toc-highlight">Message routing</a></li><li><a href="#async-send" class="table-of-contents__link toc-highlight">Async send</a></li><li><a href="#configuring-messages" class="table-of-contents__link toc-highlight">Configuring messages</a></li></ul></li><li><a href="#consumers" class="table-of-contents__link toc-highlight">Consumers</a><ul><li><a href="#configuring-consumers" class="table-of-contents__link toc-highlight">Configuring consumers</a></li><li><a href="#async-receive" class="table-of-contents__link toc-highlight">Async receive</a></li><li><a href="#multi-topic-subscriptions" class="table-of-contents__link toc-highlight">Multi-topic subscriptions</a></li></ul></li><li><a href="#reader-interface" class="table-of-contents__link toc-highlight">Reader interface</a></li><li><a href="#schemas" class="table-of-contents__link toc-highlight">Schemas</a><ul><li><a href="#schema-example" class="table-of-contents__link toc-highlight">Schema example</a></li></ul></li><li><a href="#authentication" class="table-of-contents__link toc-highlight">Authentication</a><ul><li><a href="#tls-authentication" class="table-of-contents__link toc-highlight">TLS Authentication</a></li><li><a href="#athenz" class="table-of-contents__link toc-highlight">Athenz</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Apache Foundation.</div><ul class="footer__items"><li class="footer__item">
	              <img src="/img/Apache_Feather_Logo.svg" alt="" width="20">
	              </li><li class="footer__item"><a href="http://www.apache.org/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Foundation<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/events/current-event.html" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Events<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>License<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/thanks" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Thanks<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/security" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Security<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://www.apache.org/foundation/sponsorship" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Sponsorship<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title"> </div><ul class="footer__items"><li class="footer__item">
	              <div><small><strong>Apache Pulsar is available under the <a href="/">Apache License, version 2.0.</a></strong></small></div>
                <div>Apache Pulsar is a distributed, open source pub-sub messaging and streaming platform for real-time workloads, managing hundreds of billions of events per day.</div>
	              </li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_SRtH" href="/zh-CN/"><img src="/zh-CN/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="/zh-CN/img/pulsar-white.svg" alt="Pulsar Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></a></div><div class="footer__copyright"><p>Apache Pulsar is available under the Apache License, version 2.0.</p>
      <p>Copyright © 2022 The Apache Software Foundation. All Rights Reserved. Apache, Apache Pulsar and the Apache feather logo are trademarks of The Apache Software Foundation.</p></div></div></div></footer></div>
<script src="/zh-CN/assets/js/runtime~main.701451b8.js"></script>
<script src="/zh-CN/assets/js/main.e8b2c7c8.js"></script>
</body>
</html>
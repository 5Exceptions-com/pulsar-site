<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>PendingAckHandleImpl (Pulsar Broker 2.11.0-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.pulsar.broker.transaction.pendingack.impl, class: PendingAckHandleImpl">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/PendingAckHandleImpl.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li><a href="#nested-class-summary">Nested</a>&nbsp;|&nbsp;</li>
<li><a href="#field-summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor-summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li><a href="#constructor-detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.pulsar.broker.transaction.pendingack.impl</a></div>
<h1 title="Class PendingAckHandleImpl" class="title">Class PendingAckHandleImpl</h1>
</div>
<div class="inheritance" title="Inheritance Tree"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">java.lang.Object</a>
<div class="inheritance"><a href="PendingAckHandleState.html" title="class in org.apache.pulsar.broker.transaction.pendingack.impl">org.apache.pulsar.broker.transaction.pendingack.impl.PendingAckHandleState</a>
<div class="inheritance">org.apache.pulsar.broker.transaction.pendingack.impl.PendingAckHandleImpl</div>
</div>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Implemented Interfaces:</dt>
<dd><code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="modifiers">public class </span><span class="element-name type-name-label">PendingAckHandleImpl</span>
<span class="extends-implements">extends <a href="PendingAckHandleState.html" title="class in org.apache.pulsar.broker.transaction.pendingack.impl">PendingAckHandleState</a>
implements <a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></span></div>
<div class="block">The default implementation of <a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack"><code>PendingAckHandle</code></a>.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ======== NESTED CLASS SUMMARY ======== -->
<li>
<section class="nested-class-summary" id="nested-class-summary">
<h2>Nested Class Summary</h2>
<div class="inherited-list">
<h2 id="nested-classes-inherited-from-class-org.apache.pulsar.broker.transaction.pendingack.impl.PendingAckHandleState">Nested classes/interfaces inherited from class&nbsp;org.apache.pulsar.broker.transaction.pendingack.impl.<a href="PendingAckHandleState.html" title="class in org.apache.pulsar.broker.transaction.pendingack.impl">PendingAckHandleState</a></h2>
<code><a href="PendingAckHandleState.State.html" title="enum class in org.apache.pulsar.broker.transaction.pendingack.impl">PendingAckHandleState.State</a></code></div>
</section>
</li>
<!-- =========== FIELD SUMMARY =========== -->
<li>
<section class="field-summary" id="field-summary">
<h2>Field Summary</h2>
<div class="inherited-list">
<h3 id="fields-inherited-from-class-org.apache.pulsar.broker.transaction.pendingack.impl.PendingAckHandleState">Fields inherited from class&nbsp;org.apache.pulsar.broker.transaction.pendingack.impl.<a href="PendingAckHandleState.html" title="class in org.apache.pulsar.broker.transaction.pendingack.impl">PendingAckHandleState</a></h3>
<code><a href="PendingAckHandleState.html#state">state</a></code></div>
</section>
</li>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<li>
<section class="constructor-summary" id="constructor-summary">
<h2>Constructor Summary</h2>
<div class="caption"><span>Constructors</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Constructor</div>
<div class="table-header col-last">Description</div>
<div class="col-constructor-name even-row-color"><code><a href="#%3Cinit%3E(org.apache.pulsar.broker.service.persistent.PersistentSubscription)" class="member-name-link">PendingAckHandleImpl</a><wbr>(<a href="../../../service/persistent/PersistentSubscription.html" title="class in org.apache.pulsar.broker.service.persistent">PersistentSubscription</a>&nbsp;persistentSubscription)</code></div>
<div class="col-last even-row-color">&nbsp;</div>
</div>
</section>
</li>
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab4" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab4', 3)" class="table-tab">Concrete Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#abortTxn(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.broker.service.Consumer,long)" class="member-name-link">abortTxn</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnId,
 <a href="../../../service/Consumer.html" title="class in org.apache.pulsar.broker.service">Consumer</a>&nbsp;consumer,
 long&nbsp;lowWaterMark)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Abort a transaction.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#checkIfPendingAckStoreInit()" class="member-name-link">checkIfPendingAckStoreInit</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Check if the PendingAckStore is init.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#checkIsCanDeleteConsumerPendingAck(org.apache.bookkeeper.mledger.impl.PositionImpl)" class="member-name-link">checkIsCanDeleteConsumerPendingAck</a><wbr>(org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Judge the all ack set point have acked by normal ack and transaction pending ack.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#clearIndividualPosition(org.apache.bookkeeper.mledger.Position)" class="member-name-link">clearIndividualPosition</a><wbr>(org.apache.bookkeeper.mledger.Position&nbsp;position)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">When the position is actually deleted, we can use this method to clear the cache for individual ack messages.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#close()" class="member-name-link">close</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Close the pending ack handle.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#commitTxn(org.apache.pulsar.client.api.transaction.TxnID,java.util.Map,long)" class="member-name-link">commitTxn</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;properties,
 long&nbsp;lowWaterMark)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Commit a transaction.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#completeHandleFuture()" class="member-name-link">completeHandleFuture</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#cumulativeAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)" class="member-name-link">cumulativeAcknowledgeMessage</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.bookkeeper.mledger.impl.PositionImpl&gt;&nbsp;positions)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Acknowledge message(s) for an ongoing transaction.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#exceptionHandleFuture(java.lang.Throwable)" class="member-name-link">exceptionHandleFuture</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&nbsp;t)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>org.apache.pulsar.common.policies.data.TransactionPendingAckStats</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getStats(boolean)" class="member-name-link">getStats</a><wbr>(boolean&nbsp;lowWaterMarks)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get pending ack handle stats.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;org.apache.bookkeeper.mledger.ManagedLedger&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getStoreManageLedger()" class="member-name-link">getStoreManageLedger</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getSubName()" class="member-name-link">getSubName</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getTopicName()" class="member-name-link">getTopicName</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>org.apache.pulsar.common.policies.data.TransactionInPendingAckStats</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#getTransactionInPendingAckStats(org.apache.pulsar.client.api.transaction.TxnID)" class="member-name-link">getTransactionInPendingAckStats</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Get transaction in pending ack stats.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleAbort(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.common.api.proto.CommandAck.AckType)" class="member-name-link">handleAbort</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 org.apache.pulsar.common.api.proto.CommandAck.AckType&nbsp;ackType)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleCacheRequest()" class="member-name-link">handleCacheRequest</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleCommit(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.common.api.proto.CommandAck.AckType,java.util.Map)" class="member-name-link">handleCommit</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 org.apache.pulsar.common.api.proto.CommandAck.AckType&nbsp;ackType,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;properties)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleCumulativeAckRecover(org.apache.pulsar.client.api.transaction.TxnID,org.apache.bookkeeper.mledger.impl.PositionImpl)" class="member-name-link">handleCumulativeAckRecover</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>protected void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#handleIndividualAckRecover(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)" class="member-name-link">handleIndividualAckRecover</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.commons.lang3.tuple.MutablePair&lt;org.apache.bookkeeper.mledger.impl.PositionImpl,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&gt;&nbsp;positions)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#individualAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)" class="member-name-link">individualAcknowledgeMessage</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.commons.lang3.tuple.MutablePair&lt;org.apache.bookkeeper.mledger.impl.PositionImpl,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&gt;&nbsp;positions)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Acknowledge message(s) for an ongoing transaction.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#internalAbortTxn(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.broker.service.Consumer,long,java.util.concurrent.CompletableFuture)" class="member-name-link">internalAbortTxn</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnId,
 <a href="../../../service/Consumer.html" title="class in org.apache.pulsar.broker.service">Consumer</a>&nbsp;consumer,
 long&nbsp;lowWaterMark,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;&nbsp;abortFuture)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#internalCumulativeAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List,java.util.concurrent.CompletableFuture)" class="member-name-link">internalCumulativeAcknowledgeMessage</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.bookkeeper.mledger.impl.PositionImpl&gt;&nbsp;positions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;&nbsp;completableFuture)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#internalIndividualAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List,java.util.concurrent.CompletableFuture)" class="member-name-link">internalIndividualAcknowledgeMessage</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.commons.lang3.tuple.MutablePair&lt;org.apache.bookkeeper.mledger.impl.PositionImpl,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&gt;&nbsp;positions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;&nbsp;completableFuture)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">&nbsp;</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#pendingAckHandleFuture()" class="member-name-link">pendingAckHandleFuture</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Pending ack recover whether ready future.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code>void</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4"><code><a href="#syncBatchPositionAckSetForTransaction(org.apache.bookkeeper.mledger.impl.PositionImpl)" class="member-name-link">syncBatchPositionAckSetForTransaction</a><wbr>(org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab4">
<div class="block">Sync the position ack set, in order to clean up the cache of this position for pending ack handle.</div>
</div>
</div>
</div>
</div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-org.apache.pulsar.broker.transaction.pendingack.impl.PendingAckHandleState">Methods inherited from class&nbsp;org.apache.pulsar.broker.transaction.pendingack.impl.<a href="PendingAckHandleState.html" title="class in org.apache.pulsar.broker.transaction.pendingack.impl">PendingAckHandleState</a></h3>
<code><a href="PendingAckHandleState.html#changeToCloseState()">changeToCloseState</a>, <a href="PendingAckHandleState.html#changeToErrorState()">changeToErrorState</a>, <a href="PendingAckHandleState.html#changeToInitializingState()">changeToInitializingState</a>, <a href="PendingAckHandleState.html#changeToReadyState()">changeToReadyState</a>, <a href="PendingAckHandleState.html#checkIfClose()">checkIfClose</a>, <a href="PendingAckHandleState.html#checkIfReady()">checkIfReady</a>, <a href="PendingAckHandleState.html#getState()">getState</a></code></div>
<div class="inherited-list">
<h3 id="methods-inherited-from-class-java.lang.Object">Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html" title="class or interface in java.lang" class="external-link">Object</a></h3>
<code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#clone()" title="class or interface in java.lang" class="external-link">clone</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#equals(java.lang.Object)" title="class or interface in java.lang" class="external-link">equals</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#finalize()" title="class or interface in java.lang" class="external-link">finalize</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#getClass()" title="class or interface in java.lang" class="external-link">getClass</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#hashCode()" title="class or interface in java.lang" class="external-link">hashCode</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notify()" title="class or interface in java.lang" class="external-link">notify</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#notifyAll()" title="class or interface in java.lang" class="external-link">notifyAll</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#toString()" title="class or interface in java.lang" class="external-link">toString</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait()" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long)" title="class or interface in java.lang" class="external-link">wait</a>, <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Object.html#wait(long,int)" title="class or interface in java.lang" class="external-link">wait</a></code></div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<li>
<section class="constructor-details" id="constructor-detail">
<h2>Constructor Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="&lt;init&gt;(org.apache.pulsar.broker.service.persistent.PersistentSubscription)">
<h3>PendingAckHandleImpl</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="element-name">PendingAckHandleImpl</span><wbr><span class="parameters">(<a href="../../../service/persistent/PersistentSubscription.html" title="class in org.apache.pulsar.broker.service.persistent">PersistentSubscription</a>&nbsp;persistentSubscription)</span></div>
</section>
</li>
</ul>
</section>
</li>
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="internalIndividualAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List,java.util.concurrent.CompletableFuture)">
<h3>internalIndividualAcknowledgeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">internalIndividualAcknowledgeMessage</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.commons.lang3.tuple.MutablePair&lt;org.apache.bookkeeper.mledger.impl.PositionImpl,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&gt;&nbsp;positions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;&nbsp;completableFuture)</span></div>
</section>
</li>
<li>
<section class="detail" id="individualAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">
<h3>individualAcknowledgeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">individualAcknowledgeMessage</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.commons.lang3.tuple.MutablePair&lt;org.apache.bookkeeper.mledger.impl.PositionImpl,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&gt;&nbsp;positions)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#individualAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">PendingAckHandle</a></code></span></div>
<div class="block">Acknowledge message(s) for an ongoing transaction.
 <p>
 It can be of <code>CommandAck.AckType.Individual</code>. Single messages acked by ongoing transaction will be put
 in pending_ack state and only marked as deleted after transaction is committed.
 <p>
 If transaction is aborted all messages acked by it will be put back to pending state.
 <p>
 Client will not send batch size to server, we get the batch size from consumer pending ack. When we get the Batch
 size, we can accurate batch ack of this position.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#individualAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">individualAcknowledgeMessage</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>txnID</code> - <code>TxnID</code> TransactionID of an ongoing transaction trying to sck message.</dd>
<dd><code>positions</code> - <code>MutablePair</code> the pair of positions and these batch size.</dd>
<dt>Returns:</dt>
<dd>the future of this operation.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="internalCumulativeAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List,java.util.concurrent.CompletableFuture)">
<h3>internalCumulativeAcknowledgeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">internalCumulativeAcknowledgeMessage</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.bookkeeper.mledger.impl.PositionImpl&gt;&nbsp;positions,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;&nbsp;completableFuture)</span></div>
</section>
</li>
<li>
<section class="detail" id="cumulativeAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">
<h3>cumulativeAcknowledgeMessage</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">cumulativeAcknowledgeMessage</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.bookkeeper.mledger.impl.PositionImpl&gt;&nbsp;positions)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#cumulativeAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">PendingAckHandle</a></code></span></div>
<div class="block">Acknowledge message(s) for an ongoing transaction.
 <p>
 It can be of <code>CommandAck.AckType.Cumulative</code>. Single messages acked by ongoing transaction will be put in
 pending_ack state and only marked as deleted after transaction is committed.
 <p>
 For a moment, we only allow one transaction cumulative ack multiple times when the position is greater than the
 old one.
 <p>
 We have a transaction with cumulative ack, if other transaction want to cumulative ack, we will
 return <code>TransactionConflictException</code>.
 <p>
 If an ongoing transaction cumulative acked a message and then try to ack single message which is
 greater than that one it cumulative acked, it'll succeed.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#cumulativeAcknowledgeMessage(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">cumulativeAcknowledgeMessage</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>txnID</code> - <code>TxnID</code> TransactionID of an ongoing transaction trying to sck message.</dd>
<dd><code>positions</code> - <code>MutablePair</code> the pair of positions and these batch size.</dd>
<dt>Returns:</dt>
<dd>the future of this operation.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="commitTxn(org.apache.pulsar.client.api.transaction.TxnID,java.util.Map,long)">
<h3>commitTxn</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">commitTxn</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;properties,
 long&nbsp;lowWaterMark)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#commitTxn(org.apache.pulsar.client.api.transaction.TxnID,java.util.Map,long)">PendingAckHandle</a></code></span></div>
<div class="block">Commit a transaction.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#commitTxn(org.apache.pulsar.client.api.transaction.TxnID,java.util.Map,long)">commitTxn</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>txnID</code> - <code>TxnID</code> to identify the transaction.</dd>
<dd><code>properties</code> - Additional user-defined properties that can be
                   associated with a particular cursor position.</dd>
<dd><code>lowWaterMark</code> - the low water mark of this transaction</dd>
<dt>Returns:</dt>
<dd>the future of this operation.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="internalAbortTxn(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.broker.service.Consumer,long,java.util.concurrent.CompletableFuture)">
<h3>internalAbortTxn</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">internalAbortTxn</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnId,
 <a href="../../../service/Consumer.html" title="class in org.apache.pulsar.broker.service">Consumer</a>&nbsp;consumer,
 long&nbsp;lowWaterMark,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;&nbsp;abortFuture)</span></div>
</section>
</li>
<li>
<section class="detail" id="abortTxn(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.broker.service.Consumer,long)">
<h3>abortTxn</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">abortTxn</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnId,
 <a href="../../../service/Consumer.html" title="class in org.apache.pulsar.broker.service">Consumer</a>&nbsp;consumer,
 long&nbsp;lowWaterMark)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#abortTxn(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.broker.service.Consumer,long)">PendingAckHandle</a></code></span></div>
<div class="block">Abort a transaction.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#abortTxn(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.broker.service.Consumer,long)">abortTxn</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>txnId</code> - <code>TxnID</code> to identify the transaction.</dd>
<dd><code>consumer</code> - <a href="../../../service/Consumer.html" title="class in org.apache.pulsar.broker.service"><code>Consumer</code></a> which aborting transaction.</dd>
<dd><code>lowWaterMark</code> - the low water mark of this transaction</dd>
<dt>Returns:</dt>
<dd>the future of this operation.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="syncBatchPositionAckSetForTransaction(org.apache.bookkeeper.mledger.impl.PositionImpl)">
<h3>syncBatchPositionAckSetForTransaction</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">syncBatchPositionAckSetForTransaction</span><wbr><span class="parameters">(org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#syncBatchPositionAckSetForTransaction(org.apache.bookkeeper.mledger.impl.PositionImpl)">PendingAckHandle</a></code></span></div>
<div class="block">Sync the position ack set, in order to clean up the cache of this position for pending ack handle.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#syncBatchPositionAckSetForTransaction(org.apache.bookkeeper.mledger.impl.PositionImpl)">syncBatchPositionAckSetForTransaction</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>position</code> - <code>Position</code> which position need to sync and carry it batch size</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkIsCanDeleteConsumerPendingAck(org.apache.bookkeeper.mledger.impl.PositionImpl)">
<h3>checkIsCanDeleteConsumerPendingAck</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">checkIsCanDeleteConsumerPendingAck</span><wbr><span class="parameters">(org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#checkIsCanDeleteConsumerPendingAck(org.apache.bookkeeper.mledger.impl.PositionImpl)">PendingAckHandle</a></code></span></div>
<div class="block">Judge the all ack set point have acked by normal ack and transaction pending ack.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#checkIsCanDeleteConsumerPendingAck(org.apache.bookkeeper.mledger.impl.PositionImpl)">checkIsCanDeleteConsumerPendingAck</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>position</code> - <code>Position</code> which position need to check</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="handleAbort(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.common.api.proto.CommandAck.AckType)">
<h3>handleAbort</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleAbort</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 org.apache.pulsar.common.api.proto.CommandAck.AckType&nbsp;ackType)</span></div>
</section>
</li>
<li>
<section class="detail" id="handleCommit(org.apache.pulsar.client.api.transaction.TxnID,org.apache.pulsar.common.api.proto.CommandAck.AckType,java.util.Map)">
<h3>handleCommit</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleCommit</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 org.apache.pulsar.common.api.proto.CommandAck.AckType&nbsp;ackType,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/Map.html" title="class or interface in java.util" class="external-link">Map</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a>,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;properties)</span></div>
</section>
</li>
<li>
<section class="detail" id="handleCumulativeAckRecover(org.apache.pulsar.client.api.transaction.TxnID,org.apache.bookkeeper.mledger.impl.PositionImpl)">
<h3>handleCumulativeAckRecover</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleCumulativeAckRecover</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</span></div>
</section>
</li>
<li>
<section class="detail" id="handleIndividualAckRecover(org.apache.pulsar.client.api.transaction.TxnID,java.util.List)">
<h3>handleIndividualAckRecover</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleIndividualAckRecover</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 <a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;org.apache.commons.lang3.tuple.MutablePair&lt;org.apache.bookkeeper.mledger.impl.PositionImpl,<wbr><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Integer.html" title="class or interface in java.lang" class="external-link">Integer</a>&gt;&gt;&nbsp;positions)</span></div>
</section>
</li>
<li>
<section class="detail" id="getTopicName()">
<h3>getTopicName</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getTopicName</span>()</div>
</section>
</li>
<li>
<section class="detail" id="getSubName()">
<h3>getSubName</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/String.html" title="class or interface in java.lang" class="external-link">String</a></span>&nbsp;<span class="element-name">getSubName</span>()</div>
</section>
</li>
<li>
<section class="detail" id="clearIndividualPosition(org.apache.bookkeeper.mledger.Position)">
<h3>clearIndividualPosition</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">clearIndividualPosition</span><wbr><span class="parameters">(org.apache.bookkeeper.mledger.Position&nbsp;position)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#clearIndividualPosition(org.apache.bookkeeper.mledger.Position)">PendingAckHandle</a></code></span></div>
<div class="block">When the position is actually deleted, we can use this method to clear the cache for individual ack messages.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#clearIndividualPosition(org.apache.bookkeeper.mledger.Position)">clearIndividualPosition</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>position</code> - <code>Position</code> which position need to clear</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="pendingAckHandleFuture()">
<h3>pendingAckHandleFuture</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a>&gt;</span>&nbsp;<span class="element-name">pendingAckHandleFuture</span>()</div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#pendingAckHandleFuture()">PendingAckHandle</a></code></span></div>
<div class="block">Pending ack recover whether ready future.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#pendingAckHandleFuture()">pendingAckHandleFuture</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Returns:</dt>
<dd>the future of result.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getStats(boolean)">
<h3>getStats</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">org.apache.pulsar.common.policies.data.TransactionPendingAckStats</span>&nbsp;<span class="element-name">getStats</span><wbr><span class="parameters">(boolean&nbsp;lowWaterMarks)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#getStats(boolean)">PendingAckHandle</a></code></span></div>
<div class="block">Get pending ack handle stats.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#getStats(boolean)">getStats</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Returns:</dt>
<dd>the stats of this pending ack handle.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="completeHandleFuture()">
<h3>completeHandleFuture</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">completeHandleFuture</span>()</div>
</section>
</li>
<li>
<section class="detail" id="exceptionHandleFuture(java.lang.Throwable)">
<h3>exceptionHandleFuture</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">exceptionHandleFuture</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Throwable.html" title="class or interface in java.lang" class="external-link">Throwable</a>&nbsp;t)</span></div>
</section>
</li>
<li>
<section class="detail" id="getTransactionInPendingAckStats(org.apache.pulsar.client.api.transaction.TxnID)">
<h3>getTransactionInPendingAckStats</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">org.apache.pulsar.common.policies.data.TransactionInPendingAckStats</span>&nbsp;<span class="element-name">getTransactionInPendingAckStats</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</span></div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#getTransactionInPendingAckStats(org.apache.pulsar.client.api.transaction.TxnID)">PendingAckHandle</a></code></span></div>
<div class="block">Get transaction in pending ack stats.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#getTransactionInPendingAckStats(org.apache.pulsar.client.api.transaction.TxnID)">getTransactionInPendingAckStats</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Parameters:</dt>
<dd><code>txnID</code> - the txnID</dd>
<dt>Returns:</dt>
<dd>the stats of this transaction in pending ack.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="close()">
<h3>close</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">close</span>()</div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#close()">PendingAckHandle</a></code></span></div>
<div class="block">Close the pending ack handle.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#close()">close</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Returns:</dt>
<dd>the future of this operation.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getStoreManageLedger()">
<h3>getStoreManageLedger</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;org.apache.bookkeeper.mledger.ManagedLedger&gt;</span>&nbsp;<span class="element-name">getStoreManageLedger</span>()</div>
</section>
</li>
<li>
<section class="detail" id="checkIfPendingAckStoreInit()">
<h3>checkIfPendingAckStoreInit</h3>
<div class="member-signature"><span class="modifiers">public</span>&nbsp;<span class="return-type">boolean</span>&nbsp;<span class="element-name">checkIfPendingAckStoreInit</span>()</div>
<div class="block"><span class="descfrm-type-label">Description copied from interface:&nbsp;<code><a href="../PendingAckHandle.html#checkIfPendingAckStoreInit()">PendingAckHandle</a></code></span></div>
<div class="block">Check if the PendingAckStore is init.</div>
<dl class="notes">
<dt>Specified by:</dt>
<dd><code><a href="../PendingAckHandle.html#checkIfPendingAckStoreInit()">checkIfPendingAckStoreInit</a></code>&nbsp;in interface&nbsp;<code><a href="../PendingAckHandle.html" title="interface in org.apache.pulsar.broker.transaction.pendingack">PendingAckHandle</a></code></dd>
<dt>Returns:</dt>
<dd>if the PendingAckStore is init.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="handleCacheRequest()">
<h3>handleCacheRequest</h3>
<div class="member-signature"><span class="modifiers">protected</span>&nbsp;<span class="return-type">void</span>&nbsp;<span class="element-name">handleCacheRequest</span>()</div>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2017&#x2013;2022 <a href="http://www.apache.org/">Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>

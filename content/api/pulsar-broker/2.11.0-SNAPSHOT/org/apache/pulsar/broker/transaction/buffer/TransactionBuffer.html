<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (17) -->
<title>TransactionBuffer (Pulsar Broker 2.11.0-SNAPSHOT API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description" content="declaration: package: org.apache.pulsar.broker.transaction.buffer, interface: TransactionBuffer">
<meta name="generator" content="javadoc/ClassWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../../../script.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="class-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top">
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../../../../index.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="nav-bar-cell1-rev">Class</li>
<li><a href="class-use/TransactionBuffer.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../../help-doc.html#class">Help</a></li>
</ul>
</div>
<div class="sub-nav">
<div>
<ul class="sub-nav-list">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-summary">Method</a></li>
</ul>
<ul class="sub-nav-list">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method-detail">Method</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" value="search" disabled="disabled">
<input type="reset" id="reset-button" value="reset" disabled="disabled">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="sub-title"><span class="package-label-in-type">Package</span>&nbsp;<a href="package-summary.html">org.apache.pulsar.broker.transaction.buffer</a></div>
<h1 title="Interface TransactionBuffer" class="title">Interface TransactionBuffer</h1>
</div>
<section class="class-description" id="class-description">
<dl class="notes">
<dt>All Known Implementing Classes:</dt>
<dd><code><a href="impl/TopicTransactionBuffer.html" title="class in org.apache.pulsar.broker.transaction.buffer.impl">TopicTransactionBuffer</a></code>, <code><a href="impl/TransactionBufferDisable.html" title="class in org.apache.pulsar.broker.transaction.buffer.impl">TransactionBufferDisable</a></code></dd>
</dl>
<hr>
<div class="type-signature"><span class="annotations">@Beta
</span><span class="modifiers">public interface </span><span class="element-name type-name-label">TransactionBuffer</span></div>
<div class="block">A class represent a transaction buffer. The transaction buffer
 is per partition. All the messages published within transactions
 are appended to a transaction buffer. They are not visible to consumers
 or readers before the transaction is committed.

 <p>When committing transaction starts, the broker will append a `COMMITTED`
 marker to the data partition first to mark the transaction is committed.
 The broker knows the data ledger of the commit marker and calls
 <a href="#commitTxn(org.apache.pulsar.client.api.transaction.TxnID,long)"><code>commitTxn(TxnID, long)</code></a> to commit and seal the buffer.

 <p>When the marker is appended to the data partition, all the entries are visible
 to the consumers. So a transaction reader <a href="TransactionBufferReader.html" title="interface in org.apache.pulsar.broker.transaction.buffer"><code>TransactionBufferReader</code></a> will be
 opened to read the entries when the broker sees the commit marker. There is a chance
 broker crashes after writing the marker to data partition but before committing
 the transaction in transaction buffer. That is fine. Because the transaction buffer
 will fail opening the transaction buffer reader since the transaction is still marked
 as open. The broker can keep retry until the TC (transaction coordinator) eventually
 commits the buffer again.</div>
</section>
<section class="summary">
<ul class="summary-list">
<!-- ========== METHOD SUMMARY =========== -->
<li>
<section class="method-summary" id="method-summary">
<h2>Method Summary</h2>
<div id="method-summary-table">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="method-summary-table-tab0" role="tab" aria-selected="true" aria-controls="method-summary-table.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table', 3)" class="active-table-tab">All Methods</button><button id="method-summary-table-tab2" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab2', 3)" class="table-tab">Instance Methods</button><button id="method-summary-table-tab3" role="tab" aria-selected="false" aria-controls="method-summary-table.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('method-summary-table', 'method-summary-table-tab3', 3)" class="table-tab">Abstract Methods</button></div>
<div id="method-summary-table.tabpanel" role="tabpanel">
<div class="summary-table three-column-summary" aria-labelledby="method-summary-table-tab0">
<div class="table-header col-first">Modifier and Type</div>
<div class="table-header col-second">Method</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#abortTxn(org.apache.pulsar.client.api.transaction.TxnID,long)" class="member-name-link">abortTxn</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 long&nbsp;lowWaterMark)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Abort the transaction and all the entries of this transaction will
 be discarded.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;org.apache.bookkeeper.mledger.Position&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#appendBufferToTxn(org.apache.pulsar.client.api.transaction.TxnID,long,io.netty.buffer.ByteBuf)" class="member-name-link">appendBufferToTxn</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnId,
 long&nbsp;sequenceId,
 io.netty.buffer.ByteBuf&nbsp;buffer)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Append the buffer to the transaction buffer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#checkIfTBRecoverCompletely(boolean)" class="member-name-link">checkIfTBRecoverCompletely</a><wbr>(boolean&nbsp;isTxn)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Wait TransactionBuffer Recovers completely.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#clearSnapshot()" class="member-name-link">clearSnapshot</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Clear up the snapshot of the TransactionBuffer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#closeAsync()" class="member-name-link">closeAsync</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Close the buffer asynchronously.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#commitTxn(org.apache.pulsar.client.api.transaction.TxnID,long)" class="member-name-link">commitTxn</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 long&nbsp;lowWaterMark)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Commit the transaction and seal the buffer for this transaction.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>org.apache.bookkeeper.mledger.impl.PositionImpl</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getMaxReadPosition()" class="member-name-link">getMaxReadPosition</a>()</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get the can read max position.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>org.apache.pulsar.common.policies.data.TransactionBufferStats</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getStats()" class="member-name-link">getStats</a>()</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get transaction stats in buffer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>org.apache.pulsar.common.policies.data.TransactionInBufferStats</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getTransactionInBufferStats(org.apache.pulsar.client.api.transaction.TxnID)" class="member-name-link">getTransactionInBufferStats</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Get transaction in buffer stats.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="TransactionMeta.html" title="interface in org.apache.pulsar.broker.transaction.buffer">TransactionMeta</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#getTransactionMeta(org.apache.pulsar.client.api.transaction.TxnID)" class="member-name-link">getTransactionMeta</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Return the metadata of a transaction in the buffer.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>boolean</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#isTxnAborted(org.apache.pulsar.client.api.transaction.TxnID)" class="member-name-link">isTxnAborted</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Close the buffer asynchronously.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="TransactionBufferReader.html" title="interface in org.apache.pulsar.broker.transaction.buffer">TransactionBufferReader</a>&gt;</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#openTransactionBufferReader(org.apache.pulsar.client.api.transaction.TxnID,long)" class="member-name-link">openTransactionBufferReader</a><wbr>(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 long&nbsp;startSequenceId)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Open a <a href="TransactionBufferReader.html" title="interface in org.apache.pulsar.broker.transaction.buffer"><code>TransactionBufferReader</code></a> to read entries of a given transaction
 starting from the provided <tt>sequenceId</tt>.</div>
</div>
<div class="col-first even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</code></div>
<div class="col-second even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#purgeTxns(java.util.List)" class="member-name-link">purgeTxns</a><wbr>(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;dataLedgers)</code></div>
<div class="col-last even-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Purge all the data of the transactions who are committed and stored
 in the provided data ledgers.</div>
</div>
<div class="col-first odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code>void</code></div>
<div class="col-second odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3"><code><a href="#syncMaxReadPositionForNormalPublish(org.apache.bookkeeper.mledger.impl.PositionImpl)" class="member-name-link">syncMaxReadPositionForNormalPublish</a><wbr>(org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</code></div>
<div class="col-last odd-row-color method-summary-table method-summary-table-tab2 method-summary-table-tab3">
<div class="block">Sync max read position for normal publish.</div>
</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
<section class="details">
<ul class="details-list">
<!-- ============ METHOD DETAIL ========== -->
<li>
<section class="method-details" id="method-detail">
<h2>Method Details</h2>
<ul class="member-list">
<li>
<section class="detail" id="getTransactionMeta(org.apache.pulsar.client.api.transaction.TxnID)">
<h3>getTransactionMeta</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="TransactionMeta.html" title="interface in org.apache.pulsar.broker.transaction.buffer">TransactionMeta</a>&gt;</span>&nbsp;<span class="element-name">getTransactionMeta</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</span></div>
<div class="block">Return the metadata of a transaction in the buffer.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>txnID</code> - the transaction id</dd>
<dt>Returns:</dt>
<dd>a future represents the result of the operation</dd>
<dt>Throws:</dt>
<dd><code>org.apache.pulsar.broker.transaction.buffer.exceptions.TransactionNotFoundException</code> - if the transaction
         is not in the buffer.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="appendBufferToTxn(org.apache.pulsar.client.api.transaction.TxnID,long,io.netty.buffer.ByteBuf)">
<h3>appendBufferToTxn</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;org.apache.bookkeeper.mledger.Position&gt;</span>&nbsp;<span class="element-name">appendBufferToTxn</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnId,
 long&nbsp;sequenceId,
 io.netty.buffer.ByteBuf&nbsp;buffer)</span></div>
<div class="block">Append the buffer to the transaction buffer.

 <p>The entry will be indexed by <tt>txnId</tt> and <tt>sequenceId</tt>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>txnId</code> - the transaction id</dd>
<dd><code>sequenceId</code> - the sequence id of the entry in this transaction buffer.</dd>
<dd><code>buffer</code> - the entry buffer</dd>
<dt>Returns:</dt>
<dd>a future represents the result of the operation.</dd>
<dt>Throws:</dt>
<dd><code>org.apache.pulsar.broker.transaction.buffer.exceptions.TransactionSealedException</code> - if the transaction
         has been sealed.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="openTransactionBufferReader(org.apache.pulsar.client.api.transaction.TxnID,long)">
<h3>openTransactionBufferReader</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="TransactionBufferReader.html" title="interface in org.apache.pulsar.broker.transaction.buffer">TransactionBufferReader</a>&gt;</span>&nbsp;<span class="element-name">openTransactionBufferReader</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 long&nbsp;startSequenceId)</span></div>
<div class="block">Open a <a href="TransactionBufferReader.html" title="interface in org.apache.pulsar.broker.transaction.buffer"><code>TransactionBufferReader</code></a> to read entries of a given transaction
 starting from the provided <tt>sequenceId</tt>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>txnID</code> - transaction id</dd>
<dd><code>startSequenceId</code> - the sequence id to start read</dd>
<dt>Returns:</dt>
<dd>a future represents the result of open operation.</dd>
<dt>Throws:</dt>
<dd><code>org.apache.pulsar.broker.transaction.buffer.exceptions.TransactionNotFoundException</code> - if the transaction
         is not in the buffer.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="commitTxn(org.apache.pulsar.client.api.transaction.TxnID,long)">
<h3>commitTxn</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">commitTxn</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 long&nbsp;lowWaterMark)</span></div>
<div class="block">Commit the transaction and seal the buffer for this transaction.

 <p>If a transaction is sealed, no more entries can be <a href="#appendBufferToTxn(org.apache.pulsar.client.api.transaction.TxnID,long,io.netty.buffer.ByteBuf)"><code>appendBufferToTxn(TxnID, long, ByteBuf)</code></a>.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>txnID</code> - the transaction id</dd>
<dd><code>lowWaterMark</code> - the low water mark of this transaction</dd>
<dt>Returns:</dt>
<dd>a future represents the result of commit operation.</dd>
<dt>Throws:</dt>
<dd><code>org.apache.pulsar.broker.transaction.buffer.exceptions.TransactionNotFoundException</code> - if the transaction
         is not in the buffer.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="abortTxn(org.apache.pulsar.client.api.transaction.TxnID,long)">
<h3>abortTxn</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">abortTxn</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID,
 long&nbsp;lowWaterMark)</span></div>
<div class="block">Abort the transaction and all the entries of this transaction will
 be discarded.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>txnID</code> - the transaction id</dd>
<dd><code>lowWaterMark</code> - the low water mark of this transaction</dd>
<dt>Returns:</dt>
<dd>a future represents the result of abort operation.</dd>
<dt>Throws:</dt>
<dd><code>org.apache.pulsar.broker.transaction.buffer.exceptions.TransactionNotFoundException</code> - if the transaction
         is not in the buffer.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="purgeTxns(java.util.List)">
<h3>purgeTxns</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">purgeTxns</span><wbr><span class="parameters">(<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/List.html" title="class or interface in java.util" class="external-link">List</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Long.html" title="class or interface in java.lang" class="external-link">Long</a>&gt;&nbsp;dataLedgers)</span></div>
<div class="block">Purge all the data of the transactions who are committed and stored
 in the provided data ledgers.

 <p>This method will be called by the broker before they delete the ledgers.
 It ensures that all the transactions committed in those ledgers can be purged.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>dataLedgers</code> - the list of data ledgers.</dd>
<dt>Returns:</dt>
<dd>a future represents the result of purge operations.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="clearSnapshot()">
<h3>clearSnapshot</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">clearSnapshot</span>()</div>
<div class="block">Clear up the snapshot of the TransactionBuffer.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>Clear up operation result.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="closeAsync()">
<h3>closeAsync</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">closeAsync</span>()</div>
<div class="block">Close the buffer asynchronously.</div>
<dl class="notes">
<dt>Returns:</dt>
</dl>
</section>
</li>
<li>
<section class="detail" id="isTxnAborted(org.apache.pulsar.client.api.transaction.TxnID)">
<h3>isTxnAborted</h3>
<div class="member-signature"><span class="return-type">boolean</span>&nbsp;<span class="element-name">isTxnAborted</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</span></div>
<div class="block">Close the buffer asynchronously.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>txnID</code> - <code>TxnID</code> txnId.</dd>
<dt>Returns:</dt>
<dd>the txnId is aborted.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="syncMaxReadPositionForNormalPublish(org.apache.bookkeeper.mledger.impl.PositionImpl)">
<h3>syncMaxReadPositionForNormalPublish</h3>
<div class="member-signature"><span class="return-type">void</span>&nbsp;<span class="element-name">syncMaxReadPositionForNormalPublish</span><wbr><span class="parameters">(org.apache.bookkeeper.mledger.impl.PositionImpl&nbsp;position)</span></div>
<div class="block">Sync max read position for normal publish.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>position</code> - <code>PositionImpl</code> the position to sync.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getMaxReadPosition()">
<h3>getMaxReadPosition</h3>
<div class="member-signature"><span class="return-type">org.apache.bookkeeper.mledger.impl.PositionImpl</span>&nbsp;<span class="element-name">getMaxReadPosition</span>()</div>
<div class="block">Get the can read max position.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the stable position.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getTransactionInBufferStats(org.apache.pulsar.client.api.transaction.TxnID)">
<h3>getTransactionInBufferStats</h3>
<div class="member-signature"><span class="return-type">org.apache.pulsar.common.policies.data.TransactionInBufferStats</span>&nbsp;<span class="element-name">getTransactionInBufferStats</span><wbr><span class="parameters">(org.apache.pulsar.client.api.transaction.TxnID&nbsp;txnID)</span></div>
<div class="block">Get transaction in buffer stats.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the transaction in buffer stats.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="getStats()">
<h3>getStats</h3>
<div class="member-signature"><span class="return-type">org.apache.pulsar.common.policies.data.TransactionBufferStats</span>&nbsp;<span class="element-name">getStats</span>()</div>
<div class="block">Get transaction stats in buffer.</div>
<dl class="notes">
<dt>Returns:</dt>
<dd>the transaction stats in buffer.</dd>
</dl>
</section>
</li>
<li>
<section class="detail" id="checkIfTBRecoverCompletely(boolean)">
<h3>checkIfTBRecoverCompletely</h3>
<div class="member-signature"><span class="return-type"><a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/util/concurrent/CompletableFuture.html" title="class or interface in java.util.concurrent" class="external-link">CompletableFuture</a>&lt;<a href="https://docs.oracle.com/en/java/javase/17/docs/api/java.base/java/lang/Void.html" title="class or interface in java.lang" class="external-link">Void</a>&gt;</span>&nbsp;<span class="element-name">checkIfTBRecoverCompletely</span><wbr><span class="parameters">(boolean&nbsp;isTxn)</span></div>
<div class="block">Wait TransactionBuffer Recovers completely.
 Take snapshot after TB Recovers completely.</div>
<dl class="notes">
<dt>Parameters:</dt>
<dd><code>isTxn</code> - </dd>
<dt>Returns:</dt>
<dd>a future which has completely if isTxn = false. Or a future return by takeSnapshot.</dd>
</dl>
</section>
</li>
</ul>
</section>
</li>
</ul>
</section>
<!-- ========= END OF CLASS DATA ========= -->
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2017&#x2013;2022 <a href="http://www.apache.org/">Apache Software Foundation</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
